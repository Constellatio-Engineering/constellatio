/*! For license information please see 8818.42d717e7.iframe.bundle.js.LICENSE.txt */
(self.webpackChunkconstellatio=self.webpackChunkconstellatio||[]).push([[8818],{"./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}__webpack_require__.d(__webpack_exports__,{Z:()=>_asyncToGenerator})},"./node_modules/@babel/runtime/helpers/regeneratorRuntime.js":(module,__unused_webpack_exports,__webpack_require__)=>{var _typeof=__webpack_require__("./node_modules/@babel/runtime/helpers/typeof.js").default;function _regeneratorRuntime(){"use strict";module.exports=_regeneratorRuntime=function _regeneratorRuntime(){return exports},module.exports.__esModule=!0,module.exports.default=module.exports;var exports={},Op=Object.prototype,hasOwn=Op.hasOwnProperty,defineProperty=Object.defineProperty||function(obj,key,desc){obj[key]=desc.value},$Symbol="function"==typeof Symbol?Symbol:{},iteratorSymbol=$Symbol.iterator||"@@iterator",asyncIteratorSymbol=$Symbol.asyncIterator||"@@asyncIterator",toStringTagSymbol=$Symbol.toStringTag||"@@toStringTag";function define(obj,key,value){return Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}),obj[key]}try{define({},"")}catch(err){define=function define(obj,key,value){return obj[key]=value}}function wrap(innerFn,outerFn,self,tryLocsList){var protoGenerator=outerFn&&outerFn.prototype instanceof Generator?outerFn:Generator,generator=Object.create(protoGenerator.prototype),context=new Context(tryLocsList||[]);return defineProperty(generator,"_invoke",{value:makeInvokeMethod(innerFn,self,context)}),generator}function tryCatch(fn,obj,arg){try{return{type:"normal",arg:fn.call(obj,arg)}}catch(err){return{type:"throw",arg:err}}}exports.wrap=wrap;var ContinueSentinel={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var IteratorPrototype={};define(IteratorPrototype,iteratorSymbol,(function(){return this}));var getProto=Object.getPrototypeOf,NativeIteratorPrototype=getProto&&getProto(getProto(values([])));NativeIteratorPrototype&&NativeIteratorPrototype!==Op&&hasOwn.call(NativeIteratorPrototype,iteratorSymbol)&&(IteratorPrototype=NativeIteratorPrototype);var Gp=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(IteratorPrototype);function defineIteratorMethods(prototype){["next","throw","return"].forEach((function(method){define(prototype,method,(function(arg){return this._invoke(method,arg)}))}))}function AsyncIterator(generator,PromiseImpl){function invoke(method,arg,resolve,reject){var record=tryCatch(generator[method],generator,arg);if("throw"!==record.type){var result=record.arg,value=result.value;return value&&"object"==_typeof(value)&&hasOwn.call(value,"__await")?PromiseImpl.resolve(value.__await).then((function(value){invoke("next",value,resolve,reject)}),(function(err){invoke("throw",err,resolve,reject)})):PromiseImpl.resolve(value).then((function(unwrapped){result.value=unwrapped,resolve(result)}),(function(error){return invoke("throw",error,resolve,reject)}))}reject(record.arg)}var previousPromise;defineProperty(this,"_invoke",{value:function value(method,arg){function callInvokeWithMethodAndArg(){return new PromiseImpl((function(resolve,reject){invoke(method,arg,resolve,reject)}))}return previousPromise=previousPromise?previousPromise.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(innerFn,self,context){var state="suspendedStart";return function(method,arg){if("executing"===state)throw new Error("Generator is already running");if("completed"===state){if("throw"===method)throw arg;return doneResult()}for(context.method=method,context.arg=arg;;){var delegate=context.delegate;if(delegate){var delegateResult=maybeInvokeDelegate(delegate,context);if(delegateResult){if(delegateResult===ContinueSentinel)continue;return delegateResult}}if("next"===context.method)context.sent=context._sent=context.arg;else if("throw"===context.method){if("suspendedStart"===state)throw state="completed",context.arg;context.dispatchException(context.arg)}else"return"===context.method&&context.abrupt("return",context.arg);state="executing";var record=tryCatch(innerFn,self,context);if("normal"===record.type){if(state=context.done?"completed":"suspendedYield",record.arg===ContinueSentinel)continue;return{value:record.arg,done:context.done}}"throw"===record.type&&(state="completed",context.method="throw",context.arg=record.arg)}}}function maybeInvokeDelegate(delegate,context){var methodName=context.method,method=delegate.iterator[methodName];if(void 0===method)return context.delegate=null,"throw"===methodName&&delegate.iterator.return&&(context.method="return",context.arg=void 0,maybeInvokeDelegate(delegate,context),"throw"===context.method)||"return"!==methodName&&(context.method="throw",context.arg=new TypeError("The iterator does not provide a '"+methodName+"' method")),ContinueSentinel;var record=tryCatch(method,delegate.iterator,context.arg);if("throw"===record.type)return context.method="throw",context.arg=record.arg,context.delegate=null,ContinueSentinel;var info=record.arg;return info?info.done?(context[delegate.resultName]=info.value,context.next=delegate.nextLoc,"return"!==context.method&&(context.method="next",context.arg=void 0),context.delegate=null,ContinueSentinel):info:(context.method="throw",context.arg=new TypeError("iterator result is not an object"),context.delegate=null,ContinueSentinel)}function pushTryEntry(locs){var entry={tryLoc:locs[0]};1 in locs&&(entry.catchLoc=locs[1]),2 in locs&&(entry.finallyLoc=locs[2],entry.afterLoc=locs[3]),this.tryEntries.push(entry)}function resetTryEntry(entry){var record=entry.completion||{};record.type="normal",delete record.arg,entry.completion=record}function Context(tryLocsList){this.tryEntries=[{tryLoc:"root"}],tryLocsList.forEach(pushTryEntry,this),this.reset(!0)}function values(iterable){if(iterable){var iteratorMethod=iterable[iteratorSymbol];if(iteratorMethod)return iteratorMethod.call(iterable);if("function"==typeof iterable.next)return iterable;if(!isNaN(iterable.length)){var i=-1,next=function next(){for(;++i<iterable.length;)if(hasOwn.call(iterable,i))return next.value=iterable[i],next.done=!1,next;return next.value=void 0,next.done=!0,next};return next.next=next}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,defineProperty(Gp,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),defineProperty(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,toStringTagSymbol,"GeneratorFunction"),exports.isGeneratorFunction=function(genFun){var ctor="function"==typeof genFun&&genFun.constructor;return!!ctor&&(ctor===GeneratorFunction||"GeneratorFunction"===(ctor.displayName||ctor.name))},exports.mark=function(genFun){return Object.setPrototypeOf?Object.setPrototypeOf(genFun,GeneratorFunctionPrototype):(genFun.__proto__=GeneratorFunctionPrototype,define(genFun,toStringTagSymbol,"GeneratorFunction")),genFun.prototype=Object.create(Gp),genFun},exports.awrap=function(arg){return{__await:arg}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,asyncIteratorSymbol,(function(){return this})),exports.AsyncIterator=AsyncIterator,exports.async=function(innerFn,outerFn,self,tryLocsList,PromiseImpl){void 0===PromiseImpl&&(PromiseImpl=Promise);var iter=new AsyncIterator(wrap(innerFn,outerFn,self,tryLocsList),PromiseImpl);return exports.isGeneratorFunction(outerFn)?iter:iter.next().then((function(result){return result.done?result.value:iter.next()}))},defineIteratorMethods(Gp),define(Gp,toStringTagSymbol,"Generator"),define(Gp,iteratorSymbol,(function(){return this})),define(Gp,"toString",(function(){return"[object Generator]"})),exports.keys=function(val){var object=Object(val),keys=[];for(var key in object)keys.push(key);return keys.reverse(),function next(){for(;keys.length;){var key=keys.pop();if(key in object)return next.value=key,next.done=!1,next}return next.done=!0,next}},exports.values=values,Context.prototype={constructor:Context,reset:function reset(skipTempReset){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!skipTempReset)for(var name in this)"t"===name.charAt(0)&&hasOwn.call(this,name)&&!isNaN(+name.slice(1))&&(this[name]=void 0)},stop:function stop(){this.done=!0;var rootRecord=this.tryEntries[0].completion;if("throw"===rootRecord.type)throw rootRecord.arg;return this.rval},dispatchException:function dispatchException(exception){if(this.done)throw exception;var context=this;function handle(loc,caught){return record.type="throw",record.arg=exception,context.next=loc,caught&&(context.method="next",context.arg=void 0),!!caught}for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i],record=entry.completion;if("root"===entry.tryLoc)return handle("end");if(entry.tryLoc<=this.prev){var hasCatch=hasOwn.call(entry,"catchLoc"),hasFinally=hasOwn.call(entry,"finallyLoc");if(hasCatch&&hasFinally){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0);if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}else if(hasCatch){if(this.prev<entry.catchLoc)return handle(entry.catchLoc,!0)}else{if(!hasFinally)throw new Error("try statement without catch or finally");if(this.prev<entry.finallyLoc)return handle(entry.finallyLoc)}}}},abrupt:function abrupt(type,arg){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc<=this.prev&&hasOwn.call(entry,"finallyLoc")&&this.prev<entry.finallyLoc){var finallyEntry=entry;break}}finallyEntry&&("break"===type||"continue"===type)&&finallyEntry.tryLoc<=arg&&arg<=finallyEntry.finallyLoc&&(finallyEntry=null);var record=finallyEntry?finallyEntry.completion:{};return record.type=type,record.arg=arg,finallyEntry?(this.method="next",this.next=finallyEntry.finallyLoc,ContinueSentinel):this.complete(record)},complete:function complete(record,afterLoc){if("throw"===record.type)throw record.arg;return"break"===record.type||"continue"===record.type?this.next=record.arg:"return"===record.type?(this.rval=this.arg=record.arg,this.method="return",this.next="end"):"normal"===record.type&&afterLoc&&(this.next=afterLoc),ContinueSentinel},finish:function finish(finallyLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.finallyLoc===finallyLoc)return this.complete(entry.completion,entry.afterLoc),resetTryEntry(entry),ContinueSentinel}},catch:function _catch(tryLoc){for(var i=this.tryEntries.length-1;i>=0;--i){var entry=this.tryEntries[i];if(entry.tryLoc===tryLoc){var record=entry.completion;if("throw"===record.type){var thrown=record.arg;resetTryEntry(entry)}return thrown}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(iterable,resultName,nextLoc){return this.delegate={iterator:values(iterable),resultName,nextLoc},"next"===this.method&&(this.arg=void 0),ContinueSentinel}},exports}module.exports=_regeneratorRuntime,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/@babel/runtime/helpers/typeof.js":module=>{function _typeof(obj){return module.exports=_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},module.exports.__esModule=!0,module.exports.default=module.exports,_typeof(obj)}module.exports=_typeof,module.exports.__esModule=!0,module.exports.default=module.exports},"./node_modules/@babel/runtime/regenerator/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{var runtime=__webpack_require__("./node_modules/@babel/runtime/helpers/regeneratorRuntime.js")();module.exports=runtime;try{regeneratorRuntime=runtime}catch(accidentalStrictMode){"object"==typeof globalThis?globalThis.regeneratorRuntime=runtime:Function("r","regeneratorRuntime = r")(runtime)}},"./node_modules/@mantine/notifications/esm/events.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N9:()=>notifications});var _mantine_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@mantine/utils/esm/create-use-external-events/create-use-external-events.js");const[useNotificationsEvents,createEvent]=(0,_mantine_utils__WEBPACK_IMPORTED_MODULE_0__.P)("mantine-notifications"),notifications={show:createEvent("show"),hide:createEvent("hide"),clean:createEvent("clean"),cleanQueue:createEvent("cleanQueue"),update:createEvent("update")}},"./node_modules/@supabase/auth-helpers-nextjs/dist/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var mod,console=__webpack_require__("./node_modules/console-browserify/index.js"),__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,src_exports={};((target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})})(src_exports,{createBrowserSupabaseClient:()=>createBrowserSupabaseClient,createClientComponentClient:()=>createClientComponentClient,createMiddlewareClient:()=>createMiddlewareClient,createMiddlewareSupabaseClient:()=>createMiddlewareSupabaseClient,createPagesBrowserClient:()=>createPagesBrowserClient,createPagesServerClient:()=>createPagesServerClient,createRouteHandlerClient:()=>createRouteHandlerClient,createServerActionClient:()=>createServerActionClient,createServerComponentClient:()=>createServerComponentClient,createServerSupabaseClient:()=>createServerSupabaseClient}),module.exports=(mod=src_exports,((to,from,except,desc)=>{if(from&&"object"==typeof from||"function"==typeof from)for(let key of __getOwnPropNames(from))__hasOwnProp.call(to,key)||key===except||__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable});return to})(__defProp({},"__esModule",{value:!0}),mod));var supabase,import_auth_helpers_shared=__webpack_require__("./node_modules/@supabase/auth-helpers-shared/dist/index.mjs");function createClientComponentClient({supabaseUrl="https://lhwsbnnlbqazogjulect.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxod3Nibm5sYnFhem9nanVsZWN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODc5NzA4NTUsImV4cCI6MjAwMzU0Njg1NX0.jDDTsMDaYWLdCt-dPSR2vh7JlPBQhjPE_pwwenZCfTY",options,cookieOptions,isSingleton=!0}={}){if(!supabaseUrl||!supabaseKey)throw new Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");const createNewClient=()=>{var _a;return(0,import_auth_helpers_shared.createSupabaseClient)(supabaseUrl,supabaseKey,{...options,global:{...null==options?void 0:options.global,headers:{...null==(_a=null==options?void 0:options.global)?void 0:_a.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.7.2"}},auth:{storageKey:null==cookieOptions?void 0:cookieOptions.name,storage:new import_auth_helpers_shared.BrowserCookieAuthStorageAdapter(cookieOptions)}})};if(isSingleton){const _supabase=supabase??createNewClient();return"undefined"==typeof window?_supabase:(supabase||(supabase=_supabase),supabase)}return createNewClient()}var createPagesBrowserClient=createClientComponentClient,import_auth_helpers_shared2=__webpack_require__("./node_modules/@supabase/auth-helpers-shared/dist/index.mjs"),import_set_cookie_parser=__webpack_require__("./node_modules/set-cookie-parser/lib/set-cookie.js"),NextServerAuthStorageAdapter=class extends import_auth_helpers_shared2.CookieAuthStorageAdapter{constructor(context,cookieOptions){super(cookieOptions),this.context=context}getCookie(name){var _a;return(0,import_set_cookie_parser.splitCookiesString)((null==(_a=this.context.res.getHeader("set-cookie"))?void 0:_a.toString())??"").map((c=>(0,import_auth_helpers_shared2.parseCookies)(c)[name])).find((c=>!!c))??this.context.req.cookies[name]}setCookie(name,value){this._setCookie(name,value)}deleteCookie(name){this._setCookie(name,"",{maxAge:0})}_setCookie(name,value,options){var _a;const setCookies=(0,import_set_cookie_parser.splitCookiesString)((null==(_a=this.context.res.getHeader("set-cookie"))?void 0:_a.toString())??"").filter((c=>!(name in(0,import_auth_helpers_shared2.parseCookies)(c)))),cookieStr=(0,import_auth_helpers_shared2.serializeCookie)(name,value,{...this.cookieOptions,...options,httpOnly:!1});this.context.res.setHeader("set-cookie",[...setCookies,cookieStr])}};function createPagesServerClient(context,{supabaseUrl="https://lhwsbnnlbqazogjulect.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxod3Nibm5sYnFhem9nanVsZWN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODc5NzA4NTUsImV4cCI6MjAwMzU0Njg1NX0.jDDTsMDaYWLdCt-dPSR2vh7JlPBQhjPE_pwwenZCfTY",options,cookieOptions}={}){var _a;if(!supabaseUrl||!supabaseKey)throw new Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,import_auth_helpers_shared2.createSupabaseClient)(supabaseUrl,supabaseKey,{...options,global:{...null==options?void 0:options.global,headers:{...null==(_a=null==options?void 0:options.global)?void 0:_a.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.7.2"}},auth:{storageKey:null==cookieOptions?void 0:cookieOptions.name,storage:new NextServerAuthStorageAdapter(context,cookieOptions)}})}var import_auth_helpers_shared3=__webpack_require__("./node_modules/@supabase/auth-helpers-shared/dist/index.mjs"),import_set_cookie_parser2=__webpack_require__("./node_modules/set-cookie-parser/lib/set-cookie.js"),NextMiddlewareAuthStorageAdapter=class extends import_auth_helpers_shared3.CookieAuthStorageAdapter{constructor(context,cookieOptions){super(cookieOptions),this.context=context}getCookie(name){var _a;const setCookie=(0,import_set_cookie_parser2.splitCookiesString)((null==(_a=this.context.res.headers.get("set-cookie"))?void 0:_a.toString())??"").map((c=>(0,import_auth_helpers_shared3.parseCookies)(c)[name])).find((c=>!!c));if(setCookie)return setCookie;return(0,import_auth_helpers_shared3.parseCookies)(this.context.req.headers.get("cookie")??"")[name]}setCookie(name,value){this._setCookie(name,value)}deleteCookie(name){this._setCookie(name,"",{maxAge:0})}_setCookie(name,value,options){const newSessionStr=(0,import_auth_helpers_shared3.serializeCookie)(name,value,{...this.cookieOptions,...options,httpOnly:!1});this.context.res.headers&&(this.context.res.headers.append("set-cookie",newSessionStr),this.context.res.headers.append("cookie",newSessionStr))}};function createMiddlewareClient(context,{supabaseUrl="https://lhwsbnnlbqazogjulect.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxod3Nibm5sYnFhem9nanVsZWN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODc5NzA4NTUsImV4cCI6MjAwMzU0Njg1NX0.jDDTsMDaYWLdCt-dPSR2vh7JlPBQhjPE_pwwenZCfTY",options,cookieOptions}={}){var _a;if(!supabaseUrl||!supabaseKey)throw new Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,import_auth_helpers_shared3.createSupabaseClient)(supabaseUrl,supabaseKey,{...options,global:{...null==options?void 0:options.global,headers:{...null==(_a=null==options?void 0:options.global)?void 0:_a.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.7.2"}},auth:{storageKey:null==cookieOptions?void 0:cookieOptions.name,storage:new NextMiddlewareAuthStorageAdapter(context,cookieOptions)}})}var import_auth_helpers_shared4=__webpack_require__("./node_modules/@supabase/auth-helpers-shared/dist/index.mjs"),NextServerComponentAuthStorageAdapter=class extends import_auth_helpers_shared4.CookieAuthStorageAdapter{constructor(context,cookieOptions){super(cookieOptions),this.context=context}getCookie(name){var _a;return null==(_a=this.context.cookies().get(name))?void 0:_a.value}setCookie(name,value){}deleteCookie(name){}};function createServerComponentClient(context,{supabaseUrl="https://lhwsbnnlbqazogjulect.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxod3Nibm5sYnFhem9nanVsZWN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODc5NzA4NTUsImV4cCI6MjAwMzU0Njg1NX0.jDDTsMDaYWLdCt-dPSR2vh7JlPBQhjPE_pwwenZCfTY",options,cookieOptions}={}){var _a;if(!supabaseUrl||!supabaseKey)throw new Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,import_auth_helpers_shared4.createSupabaseClient)(supabaseUrl,supabaseKey,{...options,global:{...null==options?void 0:options.global,headers:{...null==(_a=null==options?void 0:options.global)?void 0:_a.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.7.2"}},auth:{storageKey:null==cookieOptions?void 0:cookieOptions.name,storage:new NextServerComponentAuthStorageAdapter(context,cookieOptions)}})}var import_auth_helpers_shared5=__webpack_require__("./node_modules/@supabase/auth-helpers-shared/dist/index.mjs"),NextRouteHandlerAuthStorageAdapter=class extends import_auth_helpers_shared5.CookieAuthStorageAdapter{constructor(context,cookieOptions){super(cookieOptions),this.context=context}getCookie(name){var _a;return null==(_a=this.context.cookies().get(name))?void 0:_a.value}setCookie(name,value){this.context.cookies().set(name,value)}deleteCookie(name){this.context.cookies().set(name,"",{maxAge:0})}};function createRouteHandlerClient(context,{supabaseUrl="https://lhwsbnnlbqazogjulect.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxod3Nibm5sYnFhem9nanVsZWN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODc5NzA4NTUsImV4cCI6MjAwMzU0Njg1NX0.jDDTsMDaYWLdCt-dPSR2vh7JlPBQhjPE_pwwenZCfTY",options,cookieOptions}={}){var _a;if(!supabaseUrl||!supabaseKey)throw new Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,import_auth_helpers_shared5.createSupabaseClient)(supabaseUrl,supabaseKey,{...options,global:{...null==options?void 0:options.global,headers:{...null==(_a=null==options?void 0:options.global)?void 0:_a.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.7.2"}},auth:{storageKey:null==cookieOptions?void 0:cookieOptions.name,storage:new NextRouteHandlerAuthStorageAdapter(context,cookieOptions)}})}var createServerActionClient=createRouteHandlerClient;function createBrowserSupabaseClient({supabaseUrl="https://lhwsbnnlbqazogjulect.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxod3Nibm5sYnFhem9nanVsZWN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODc5NzA4NTUsImV4cCI6MjAwMzU0Njg1NX0.jDDTsMDaYWLdCt-dPSR2vh7JlPBQhjPE_pwwenZCfTY",options,cookieOptions}={}){return console.warn("Please utilize the `createPagesBrowserClient` function instead of the deprecated `createBrowserSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs-pages"),createPagesBrowserClient({supabaseUrl,supabaseKey,options,cookieOptions})}function createServerSupabaseClient(context,{supabaseUrl="https://lhwsbnnlbqazogjulect.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxod3Nibm5sYnFhem9nanVsZWN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODc5NzA4NTUsImV4cCI6MjAwMzU0Njg1NX0.jDDTsMDaYWLdCt-dPSR2vh7JlPBQhjPE_pwwenZCfTY",options,cookieOptions}={}){return console.warn("Please utilize the `createPagesServerClient` function instead of the deprecated `createServerSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs-pages"),createPagesServerClient(context,{supabaseUrl,supabaseKey,options,cookieOptions})}function createMiddlewareSupabaseClient(context,{supabaseUrl="https://lhwsbnnlbqazogjulect.supabase.co",supabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxod3Nibm5sYnFhem9nanVsZWN0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODc5NzA4NTUsImV4cCI6MjAwMzU0Njg1NX0.jDDTsMDaYWLdCt-dPSR2vh7JlPBQhjPE_pwwenZCfTY",options,cookieOptions}={}){return console.warn("Please utilize the `createMiddlewareClient` function instead of the deprecated `createMiddlewareSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs#middleware"),createMiddlewareClient(context,{supabaseUrl,supabaseKey,options,cookieOptions})}},"./node_modules/@supabase/auth-helpers-shared/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{BrowserCookieAuthStorageAdapter:()=>BrowserCookieAuthStorageAdapter,CookieAuthStorageAdapter:()=>CookieAuthStorageAdapter,DEFAULT_COOKIE_OPTIONS:()=>DEFAULT_COOKIE_OPTIONS,createSupabaseClient:()=>createSupabaseClient,isBrowser:()=>dist_isBrowser,parseCookies:()=>export_parseCookies,parseSupabaseCookie:()=>parseSupabaseCookie,serializeCookie:()=>export_serializeCookie,stringifySupabaseSession:()=>stringifySupabaseSession});new TextEncoder;const buffer_utils_decoder=new TextDecoder;Symbol.asyncIterator;const webcrypto=crypto;webcrypto.getRandomValues.bind(webcrypto);Symbol();const base64url_decode=input=>{let encoded=input;encoded instanceof Uint8Array&&(encoded=buffer_utils_decoder.decode(encoded)),encoded=encoded.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return(encoded=>{const binary=atob(encoded),bytes=new Uint8Array(binary.length);for(let i=0;i<binary.length;i++)bytes[i]=binary.charCodeAt(i);return bytes})(encoded)}catch(_a){throw new TypeError("The input to be decoded is not correctly encoded.")}};var __awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class FunctionsError extends Error{constructor(message,name="FunctionsError",context){super(message),this.name=name,this.context=context}}class FunctionsFetchError extends FunctionsError{constructor(context){super("Failed to send a request to the Edge Function","FunctionsFetchError",context)}}class FunctionsRelayError extends FunctionsError{constructor(context){super("Relay Error invoking the Edge Function","FunctionsRelayError",context)}}class FunctionsHttpError extends FunctionsError{constructor(context){super("Edge Function returned a non-2xx status code","FunctionsHttpError",context)}}var FunctionsClient_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class FunctionsClient{constructor(url,{headers={},customFetch}={}){this.url=url,this.headers=headers,this.fetch=(customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?(...args)=>__awaiter(void 0,void 0,void 0,(function*(){return yield(yield Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/cross-fetch/dist/browser-ponyfill.js",23))).fetch(...args)})):fetch),(...args)=>_fetch(...args)})(customFetch)}setAuth(token){this.headers.Authorization=`Bearer ${token}`}invoke(functionName,options={}){var _a;return FunctionsClient_awaiter(this,void 0,void 0,(function*(){try{const{headers,method,body:functionArgs}=options;let body,_headers={};functionArgs&&(headers&&!Object.prototype.hasOwnProperty.call(headers,"Content-Type")||!headers)&&("undefined"!=typeof Blob&&functionArgs instanceof Blob||functionArgs instanceof ArrayBuffer?(_headers["Content-Type"]="application/octet-stream",body=functionArgs):"string"==typeof functionArgs?(_headers["Content-Type"]="text/plain",body=functionArgs):"undefined"!=typeof FormData&&functionArgs instanceof FormData?body=functionArgs:(_headers["Content-Type"]="application/json",body=JSON.stringify(functionArgs)));const response=yield this.fetch(`${this.url}/${functionName}`,{method:method||"POST",headers:Object.assign(Object.assign(Object.assign({},_headers),this.headers),headers),body}).catch((fetchError=>{throw new FunctionsFetchError(fetchError)})),isRelayError=response.headers.get("x-relay-error");if(isRelayError&&"true"===isRelayError)throw new FunctionsRelayError(response);if(!response.ok)throw new FunctionsHttpError(response);let data,responseType=(null!==(_a=response.headers.get("Content-Type"))&&void 0!==_a?_a:"text/plain").split(";")[0].trim();return data="application/json"===responseType?yield response.json():"application/octet-stream"===responseType?yield response.blob():"multipart/form-data"===responseType?yield response.formData():yield response.text(),{data,error:null}}catch(error){return{data:null,error}}}))}}var browser_ponyfill=__webpack_require__("./node_modules/cross-fetch/dist/browser-ponyfill.js"),browser_ponyfill_default=__webpack_require__.n(browser_ponyfill);class PostgrestBuilder{constructor(builder){this.shouldThrowOnError=!1,this.method=builder.method,this.url=builder.url,this.headers=builder.headers,this.schema=builder.schema,this.body=builder.body,this.shouldThrowOnError=builder.shouldThrowOnError,this.signal=builder.signal,this.isMaybeSingle=builder.isMaybeSingle,builder.fetch?this.fetch=builder.fetch:"undefined"==typeof fetch?this.fetch=browser_ponyfill_default():this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(onfulfilled,onrejected){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let res=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async res=>{var _a,_b,_c;let error=null,data=null,count=null,status=res.status,statusText=res.statusText;if(res.ok){if("HEAD"!==this.method){const body=await res.text();""===body||(data="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?body:JSON.parse(body))}const countHeader=null===(_a=this.headers.Prefer)||void 0===_a?void 0:_a.match(/count=(exact|planned|estimated)/),contentRange=null===(_b=res.headers.get("content-range"))||void 0===_b?void 0:_b.split("/");countHeader&&contentRange&&contentRange.length>1&&(count=parseInt(contentRange[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(data)&&(data.length>1?(error={code:"PGRST116",details:`Results contain ${data.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},data=null,count=null,status=406,statusText="Not Acceptable"):data=1===data.length?data[0]:null)}else{const body=await res.text();try{error=JSON.parse(body),Array.isArray(error)&&404===res.status&&(data=[],error=null,status=200,statusText="OK")}catch(_d){404===res.status&&""===body?(status=204,statusText="No Content"):error={message:body}}if(error&&this.isMaybeSingle&&(null===(_c=null==error?void 0:error.details)||void 0===_c?void 0:_c.includes("Results contain 0 rows"))&&(error=null,status=200,statusText="OK"),error&&this.shouldThrowOnError)throw error}return{error,data,count,status,statusText}}));return this.shouldThrowOnError||(res=res.catch((fetchError=>{var _a,_b,_c;return{error:{message:`${null!==(_a=null==fetchError?void 0:fetchError.name)&&void 0!==_a?_a:"FetchError"}: ${null==fetchError?void 0:fetchError.message}`,details:`${null!==(_b=null==fetchError?void 0:fetchError.stack)&&void 0!==_b?_b:""}`,hint:"",code:`${null!==(_c=null==fetchError?void 0:fetchError.code)&&void 0!==_c?_c:""}`},data:null,count:null,status:0,statusText:""}}))),res.then(onfulfilled,onrejected)}}class PostgrestTransformBuilder extends PostgrestBuilder{select(columns){let quoted=!1;const cleanedColumns=(null!=columns?columns:"*").split("").map((c=>/\s/.test(c)&&!quoted?"":('"'===c&&(quoted=!quoted),c))).join("");return this.url.searchParams.set("select",cleanedColumns),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(column,{ascending=!0,nullsFirst,foreignTable}={}){const key=foreignTable?`${foreignTable}.order`:"order",existingOrder=this.url.searchParams.get(key);return this.url.searchParams.set(key,`${existingOrder?`${existingOrder},`:""}${column}.${ascending?"asc":"desc"}${void 0===nullsFirst?"":nullsFirst?".nullsfirst":".nullslast"}`),this}limit(count,{foreignTable}={}){const key=void 0===foreignTable?"limit":`${foreignTable}.limit`;return this.url.searchParams.set(key,`${count}`),this}range(from,to,{foreignTable}={}){const keyOffset=void 0===foreignTable?"offset":`${foreignTable}.offset`,keyLimit=void 0===foreignTable?"limit":`${foreignTable}.limit`;return this.url.searchParams.set(keyOffset,`${from}`),this.url.searchParams.set(keyLimit,""+(to-from+1)),this}abortSignal(signal){return this.signal=signal,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze=!1,verbose=!1,settings=!1,buffers=!1,wal=!1,format="text"}={}){const options=[analyze?"analyze":null,verbose?"verbose":null,settings?"settings":null,buffers?"buffers":null,wal?"wal":null].filter(Boolean).join("|"),forMediatype=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${format}; for="${forMediatype}"; options=${options};`,this}rollback(){var _a;return(null!==(_a=this.headers.Prefer)&&void 0!==_a?_a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class PostgrestFilterBuilder extends PostgrestTransformBuilder{eq(column,value){return this.url.searchParams.append(column,`eq.${value}`),this}neq(column,value){return this.url.searchParams.append(column,`neq.${value}`),this}gt(column,value){return this.url.searchParams.append(column,`gt.${value}`),this}gte(column,value){return this.url.searchParams.append(column,`gte.${value}`),this}lt(column,value){return this.url.searchParams.append(column,`lt.${value}`),this}lte(column,value){return this.url.searchParams.append(column,`lte.${value}`),this}like(column,pattern){return this.url.searchParams.append(column,`like.${pattern}`),this}likeAllOf(column,patterns){return this.url.searchParams.append(column,`like(all).{${patterns.join(",")}}`),this}likeAnyOf(column,patterns){return this.url.searchParams.append(column,`like(any).{${patterns.join(",")}}`),this}ilike(column,pattern){return this.url.searchParams.append(column,`ilike.${pattern}`),this}ilikeAllOf(column,patterns){return this.url.searchParams.append(column,`ilike(all).{${patterns.join(",")}}`),this}ilikeAnyOf(column,patterns){return this.url.searchParams.append(column,`ilike(any).{${patterns.join(",")}}`),this}is(column,value){return this.url.searchParams.append(column,`is.${value}`),this}in(column,values){const cleanedValues=values.map((s=>"string"==typeof s&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`)).join(",");return this.url.searchParams.append(column,`in.(${cleanedValues})`),this}contains(column,value){return"string"==typeof value?this.url.searchParams.append(column,`cs.${value}`):Array.isArray(value)?this.url.searchParams.append(column,`cs.{${value.join(",")}}`):this.url.searchParams.append(column,`cs.${JSON.stringify(value)}`),this}containedBy(column,value){return"string"==typeof value?this.url.searchParams.append(column,`cd.${value}`):Array.isArray(value)?this.url.searchParams.append(column,`cd.{${value.join(",")}}`):this.url.searchParams.append(column,`cd.${JSON.stringify(value)}`),this}rangeGt(column,range){return this.url.searchParams.append(column,`sr.${range}`),this}rangeGte(column,range){return this.url.searchParams.append(column,`nxl.${range}`),this}rangeLt(column,range){return this.url.searchParams.append(column,`sl.${range}`),this}rangeLte(column,range){return this.url.searchParams.append(column,`nxr.${range}`),this}rangeAdjacent(column,range){return this.url.searchParams.append(column,`adj.${range}`),this}overlaps(column,value){return"string"==typeof value?this.url.searchParams.append(column,`ov.${value}`):this.url.searchParams.append(column,`ov.{${value.join(",")}}`),this}textSearch(column,query,{config,type}={}){let typePart="";"plain"===type?typePart="pl":"phrase"===type?typePart="ph":"websearch"===type&&(typePart="w");const configPart=void 0===config?"":`(${config})`;return this.url.searchParams.append(column,`${typePart}fts${configPart}.${query}`),this}match(query){return Object.entries(query).forEach((([column,value])=>{this.url.searchParams.append(column,`eq.${value}`)})),this}not(column,operator,value){return this.url.searchParams.append(column,`not.${operator}.${value}`),this}or(filters,{foreignTable}={}){const key=foreignTable?`${foreignTable}.or`:"or";return this.url.searchParams.append(key,`(${filters})`),this}filter(column,operator,value){return this.url.searchParams.append(column,`${operator}.${value}`),this}}class PostgrestQueryBuilder{constructor(url,{headers={},schema,fetch}){this.url=url,this.headers=headers,this.schema=schema,this.fetch=fetch}select(columns,{head=!1,count}={}){const method=head?"HEAD":"GET";let quoted=!1;const cleanedColumns=(null!=columns?columns:"*").split("").map((c=>/\s/.test(c)&&!quoted?"":('"'===c&&(quoted=!quoted),c))).join("");return this.url.searchParams.set("select",cleanedColumns),count&&(this.headers.Prefer=`count=${count}`),new PostgrestFilterBuilder({method,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(values,{count,defaultToNull=!0}={}){const prefersHeaders=[];if(this.headers.Prefer&&prefersHeaders.push(this.headers.Prefer),count&&prefersHeaders.push(`count=${count}`),defaultToNull||prefersHeaders.push("missing=default"),this.headers.Prefer=prefersHeaders.join(","),Array.isArray(values)){const columns=values.reduce(((acc,x)=>acc.concat(Object.keys(x))),[]);if(columns.length>0){const uniqueColumns=[...new Set(columns)].map((column=>`"${column}"`));this.url.searchParams.set("columns",uniqueColumns.join(","))}}return new PostgrestFilterBuilder({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:values,fetch:this.fetch,allowEmpty:!1})}upsert(values,{onConflict,ignoreDuplicates=!1,count,defaultToNull=!0}={}){const prefersHeaders=[`resolution=${ignoreDuplicates?"ignore":"merge"}-duplicates`];if(void 0!==onConflict&&this.url.searchParams.set("on_conflict",onConflict),this.headers.Prefer&&prefersHeaders.push(this.headers.Prefer),count&&prefersHeaders.push(`count=${count}`),defaultToNull||prefersHeaders.push("missing=default"),this.headers.Prefer=prefersHeaders.join(","),Array.isArray(values)){const columns=values.reduce(((acc,x)=>acc.concat(Object.keys(x))),[]);if(columns.length>0){const uniqueColumns=[...new Set(columns)].map((column=>`"${column}"`));this.url.searchParams.set("columns",uniqueColumns.join(","))}}return new PostgrestFilterBuilder({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:values,fetch:this.fetch,allowEmpty:!1})}update(values,{count}={}){const prefersHeaders=[];return this.headers.Prefer&&prefersHeaders.push(this.headers.Prefer),count&&prefersHeaders.push(`count=${count}`),this.headers.Prefer=prefersHeaders.join(","),new PostgrestFilterBuilder({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:values,fetch:this.fetch,allowEmpty:!1})}delete({count}={}){const prefersHeaders=[];return count&&prefersHeaders.push(`count=${count}`),this.headers.Prefer&&prefersHeaders.unshift(this.headers.Prefer),this.headers.Prefer=prefersHeaders.join(","),new PostgrestFilterBuilder({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const DEFAULT_HEADERS={"X-Client-Info":"postgrest-js/1.7.1"};class PostgrestClient{constructor(url,{headers={},schema,fetch}={}){this.url=url,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS),headers),this.schema=schema,this.fetch=fetch}from(relation){const url=new URL(`${this.url}/${relation}`);return new PostgrestQueryBuilder(url,{headers:Object.assign({},this.headers),schema:this.schema,fetch:this.fetch})}rpc(fn,args={},{head=!1,count}={}){let method;const url=new URL(`${this.url}/rpc/${fn}`);let body;head?(method="HEAD",Object.entries(args).forEach((([name,value])=>{url.searchParams.append(name,`${value}`)}))):(method="POST",body=args);const headers=Object.assign({},this.headers);return count&&(headers.Prefer=`count=${count}`),new PostgrestFilterBuilder({method,url,headers,schema:this.schema,body,fetch:this.fetch,allowEmpty:!1})}}var browser=__webpack_require__("./node_modules/websocket/lib/browser.js");const constants_DEFAULT_HEADERS={"X-Client-Info":"realtime-js/2.7.3"};var SOCKET_STATES,CHANNEL_STATES,CHANNEL_EVENTS,TRANSPORTS,CONNECTION_STATE,REALTIME_PRESENCE_LISTEN_EVENTS;!function(SOCKET_STATES){SOCKET_STATES[SOCKET_STATES.connecting=0]="connecting",SOCKET_STATES[SOCKET_STATES.open=1]="open",SOCKET_STATES[SOCKET_STATES.closing=2]="closing",SOCKET_STATES[SOCKET_STATES.closed=3]="closed"}(SOCKET_STATES||(SOCKET_STATES={})),function(CHANNEL_STATES){CHANNEL_STATES.closed="closed",CHANNEL_STATES.errored="errored",CHANNEL_STATES.joined="joined",CHANNEL_STATES.joining="joining",CHANNEL_STATES.leaving="leaving"}(CHANNEL_STATES||(CHANNEL_STATES={})),function(CHANNEL_EVENTS){CHANNEL_EVENTS.close="phx_close",CHANNEL_EVENTS.error="phx_error",CHANNEL_EVENTS.join="phx_join",CHANNEL_EVENTS.reply="phx_reply",CHANNEL_EVENTS.leave="phx_leave",CHANNEL_EVENTS.access_token="access_token"}(CHANNEL_EVENTS||(CHANNEL_EVENTS={})),function(TRANSPORTS){TRANSPORTS.websocket="websocket"}(TRANSPORTS||(TRANSPORTS={})),function(CONNECTION_STATE){CONNECTION_STATE.Connecting="connecting",CONNECTION_STATE.Open="open",CONNECTION_STATE.Closing="closing",CONNECTION_STATE.Closed="closed"}(CONNECTION_STATE||(CONNECTION_STATE={}));class Timer{constructor(callback,timerCalc){this.callback=callback,this.timerCalc=timerCalc,this.timer=void 0,this.tries=0,this.callback=callback,this.timerCalc=timerCalc}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}class Serializer{constructor(){this.HEADER_LENGTH=1}decode(rawPayload,callback){return rawPayload.constructor===ArrayBuffer?callback(this._binaryDecode(rawPayload)):callback("string"==typeof rawPayload?JSON.parse(rawPayload):{})}_binaryDecode(buffer){const view=new DataView(buffer),decoder=new TextDecoder;return this._decodeBroadcast(buffer,view,decoder)}_decodeBroadcast(buffer,view,decoder){const topicSize=view.getUint8(1),eventSize=view.getUint8(2);let offset=this.HEADER_LENGTH+2;const topic=decoder.decode(buffer.slice(offset,offset+topicSize));offset+=topicSize;const event=decoder.decode(buffer.slice(offset,offset+eventSize));offset+=eventSize;return{ref:null,topic,event,payload:JSON.parse(decoder.decode(buffer.slice(offset,buffer.byteLength)))}}}class Push{constructor(channel,event,payload={},timeout=1e4){this.channel=channel,this.event=event,this.payload=payload,this.timeout=timeout,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(timeout){this.timeout=timeout,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0;"rate limited"===this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})&&(this.rateLimited=!0)}updatePayload(payload){this.payload=Object.assign(Object.assign({},this.payload),payload)}receive(status,callback){var _a;return this._hasReceived(status)&&callback(null===(_a=this.receivedResp)||void 0===_a?void 0:_a.response),this.recHooks.push({status,callback}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(payload=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=payload,this._matchReceive(payload)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(status,response){this.refEvent&&this.channel._trigger(this.refEvent,{status,response})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status,response}){this.recHooks.filter((h=>h.status===status)).forEach((h=>h.callback(response)))}_hasReceived(status){return this.receivedResp&&this.receivedResp.status===status}}!function(REALTIME_PRESENCE_LISTEN_EVENTS){REALTIME_PRESENCE_LISTEN_EVENTS.SYNC="sync",REALTIME_PRESENCE_LISTEN_EVENTS.JOIN="join",REALTIME_PRESENCE_LISTEN_EVENTS.LEAVE="leave"}(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(channel,opts){this.channel=channel,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const events=(null==opts?void 0:opts.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(events.state,{},(newState=>{const{onJoin,onLeave,onSync}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,newState,onJoin,onLeave),this.pendingDiffs.forEach((diff=>{this.state=RealtimePresence.syncDiff(this.state,diff,onJoin,onLeave)})),this.pendingDiffs=[],onSync()})),this.channel._on(events.diff,{},(diff=>{const{onJoin,onLeave,onSync}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(diff):(this.state=RealtimePresence.syncDiff(this.state,diff,onJoin,onLeave),onSync())})),this.onJoin(((key,currentPresences,newPresences)=>{this.channel._trigger("presence",{event:"join",key,currentPresences,newPresences})})),this.onLeave(((key,currentPresences,leftPresences)=>{this.channel._trigger("presence",{event:"leave",key,currentPresences,leftPresences})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(currentState,newState,onJoin,onLeave){const state=this.cloneDeep(currentState),transformedState=this.transformState(newState),joins={},leaves={};return this.map(state,((key,presences)=>{transformedState[key]||(leaves[key]=presences)})),this.map(transformedState,((key,newPresences)=>{const currentPresences=state[key];if(currentPresences){const newPresenceRefs=newPresences.map((m=>m.presence_ref)),curPresenceRefs=currentPresences.map((m=>m.presence_ref)),joinedPresences=newPresences.filter((m=>curPresenceRefs.indexOf(m.presence_ref)<0)),leftPresences=currentPresences.filter((m=>newPresenceRefs.indexOf(m.presence_ref)<0));joinedPresences.length>0&&(joins[key]=joinedPresences),leftPresences.length>0&&(leaves[key]=leftPresences)}else joins[key]=newPresences})),this.syncDiff(state,{joins,leaves},onJoin,onLeave)}static syncDiff(state,diff,onJoin,onLeave){const{joins,leaves}={joins:this.transformState(diff.joins),leaves:this.transformState(diff.leaves)};return onJoin||(onJoin=()=>{}),onLeave||(onLeave=()=>{}),this.map(joins,((key,newPresences)=>{var _a;const currentPresences=null!==(_a=state[key])&&void 0!==_a?_a:[];if(state[key]=this.cloneDeep(newPresences),currentPresences.length>0){const joinedPresenceRefs=state[key].map((m=>m.presence_ref)),curPresences=currentPresences.filter((m=>joinedPresenceRefs.indexOf(m.presence_ref)<0));state[key].unshift(...curPresences)}onJoin(key,currentPresences,newPresences)})),this.map(leaves,((key,leftPresences)=>{let currentPresences=state[key];if(!currentPresences)return;const presenceRefsToRemove=leftPresences.map((m=>m.presence_ref));currentPresences=currentPresences.filter((m=>presenceRefsToRemove.indexOf(m.presence_ref)<0)),state[key]=currentPresences,onLeave(key,currentPresences,leftPresences),0===currentPresences.length&&delete state[key]})),state}static map(obj,func){return Object.getOwnPropertyNames(obj).map((key=>func(key,obj[key])))}static transformState(state){return state=this.cloneDeep(state),Object.getOwnPropertyNames(state).reduce(((newState,key)=>{const presences=state[key];return newState[key]="metas"in presences?presences.metas.map((presence=>(presence.presence_ref=presence.phx_ref,delete presence.phx_ref,delete presence.phx_ref_prev,presence))):presences,newState}),{})}static cloneDeep(obj){return JSON.parse(JSON.stringify(obj))}onJoin(callback){this.caller.onJoin=callback}onLeave(callback){this.caller.onLeave=callback}onSync(callback){this.caller.onSync=callback}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var PostgresTypes,console=__webpack_require__("./node_modules/console-browserify/index.js");!function(PostgresTypes){PostgresTypes.abstime="abstime",PostgresTypes.bool="bool",PostgresTypes.date="date",PostgresTypes.daterange="daterange",PostgresTypes.float4="float4",PostgresTypes.float8="float8",PostgresTypes.int2="int2",PostgresTypes.int4="int4",PostgresTypes.int4range="int4range",PostgresTypes.int8="int8",PostgresTypes.int8range="int8range",PostgresTypes.json="json",PostgresTypes.jsonb="jsonb",PostgresTypes.money="money",PostgresTypes.numeric="numeric",PostgresTypes.oid="oid",PostgresTypes.reltime="reltime",PostgresTypes.text="text",PostgresTypes.time="time",PostgresTypes.timestamp="timestamp",PostgresTypes.timestamptz="timestamptz",PostgresTypes.timetz="timetz",PostgresTypes.tsrange="tsrange",PostgresTypes.tstzrange="tstzrange"}(PostgresTypes||(PostgresTypes={}));const convertChangeData=(columns,record,options={})=>{var _a;const skipTypes=null!==(_a=options.skipTypes)&&void 0!==_a?_a:[];return Object.keys(record).reduce(((acc,rec_key)=>(acc[rec_key]=convertColumn(rec_key,columns,record,skipTypes),acc)),{})},convertColumn=(columnName,columns,record,skipTypes)=>{const column=columns.find((x=>x.name===columnName)),colType=null==column?void 0:column.type,value=record[columnName];return colType&&!skipTypes.includes(colType)?convertCell(colType,value):noop(value)},convertCell=(type,value)=>{if("_"===type.charAt(0)){const dataType=type.slice(1,type.length);return toArray(value,dataType)}switch(type){case PostgresTypes.bool:return toBoolean(value);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(value);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(value);case PostgresTypes.timestamp:return toTimestampString(value);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:default:return noop(value)}},noop=value=>value,toBoolean=value=>{switch(value){case"t":return!0;case"f":return!1;default:return value}},toNumber=value=>{if("string"==typeof value){const parsedValue=parseFloat(value);if(!Number.isNaN(parsedValue))return parsedValue}return value},toJson=value=>{if("string"==typeof value)try{return JSON.parse(value)}catch(error){return console.log(`JSON parse error: ${error}`),value}return value},toArray=(value,type)=>{if("string"!=typeof value)return value;const lastIdx=value.length-1,closeBrace=value[lastIdx];if("{"===value[0]&&"}"===closeBrace){let arr;const valTrim=value.slice(1,lastIdx);try{arr=JSON.parse("["+valTrim+"]")}catch(_){arr=valTrim?valTrim.split(","):[]}return arr.map((val=>convertCell(type,val)))}return value},toTimestampString=value=>"string"==typeof value?value.replace(" ","T"):value;var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT,REALTIME_LISTEN_TYPES,REALTIME_SUBSCRIBE_STATES,RealtimeChannel_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};!function(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT){REALTIME_POSTGRES_CHANGES_LISTEN_EVENT.ALL="*",REALTIME_POSTGRES_CHANGES_LISTEN_EVENT.INSERT="INSERT",REALTIME_POSTGRES_CHANGES_LISTEN_EVENT.UPDATE="UPDATE",REALTIME_POSTGRES_CHANGES_LISTEN_EVENT.DELETE="DELETE"}(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={})),function(REALTIME_LISTEN_TYPES){REALTIME_LISTEN_TYPES.BROADCAST="broadcast",REALTIME_LISTEN_TYPES.PRESENCE="presence",REALTIME_LISTEN_TYPES.POSTGRES_CHANGES="postgres_changes"}(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={})),function(REALTIME_SUBSCRIBE_STATES){REALTIME_SUBSCRIBE_STATES.SUBSCRIBED="SUBSCRIBED",REALTIME_SUBSCRIBE_STATES.TIMED_OUT="TIMED_OUT",REALTIME_SUBSCRIBE_STATES.CLOSED="CLOSED",REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR="CHANNEL_ERROR"}(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(topic,params={config:{}},socket){this.topic=topic,this.params=params,this.socket=socket,this.bindings={},this.state=CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},params.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((pushEvent=>pushEvent.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=CHANNEL_STATES.closed,this.socket._remove(this)})),this._onError((reason=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,reason),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())})),this._on(CHANNEL_EVENTS.reply,{},((payload,ref)=>{this._trigger(this._replyEventName(ref),payload)})),this.presence=new RealtimePresence(this)}subscribe(callback,timeout=this.timeout){var _a,_b;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast,presence}}=this.params;this._onError((e=>callback&&callback("CHANNEL_ERROR",e))),this._onClose((()=>callback&&callback("CLOSED")));const accessTokenPayload={},config={broadcast,presence,postgres_changes:null!==(_b=null===(_a=this.bindings.postgres_changes)||void 0===_a?void 0:_a.map((r=>r.filter)))&&void 0!==_b?_b:[]};this.socket.accessToken&&(accessTokenPayload.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config},accessTokenPayload)),this.joinedOnce=!0,this._rejoin(timeout),this.joinPush.receive("ok",(({postgres_changes:serverPostgresFilters})=>{var _a;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0!==serverPostgresFilters){const clientPostgresBindings=this.bindings.postgres_changes,bindingsLen=null!==(_a=null==clientPostgresBindings?void 0:clientPostgresBindings.length)&&void 0!==_a?_a:0,newPostgresBindings=[];for(let i=0;i<bindingsLen;i++){const clientPostgresBinding=clientPostgresBindings[i],{filter:{event,schema,table,filter}}=clientPostgresBinding,serverPostgresFilter=serverPostgresFilters&&serverPostgresFilters[i];if(!serverPostgresFilter||serverPostgresFilter.event!==event||serverPostgresFilter.schema!==schema||serverPostgresFilter.table!==table||serverPostgresFilter.filter!==filter)return this.unsubscribe(),void(callback&&callback("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes")));newPostgresBindings.push(Object.assign(Object.assign({},clientPostgresBinding),{id:serverPostgresFilter.id}))}return this.bindings.postgres_changes=newPostgresBindings,void(callback&&callback("SUBSCRIBED"))}callback&&callback("SUBSCRIBED")})).receive("error",(error=>{callback&&callback("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(error).join(", ")||"error")))})).receive("timeout",(()=>{callback&&callback("TIMED_OUT")}))}return this}presenceState(){return this.presence.state}track(payload,opts={}){return RealtimeChannel_awaiter(this,void 0,void 0,(function*(){return yield this.send({type:"presence",event:"track",payload},opts.timeout||this.timeout)}))}untrack(opts={}){return RealtimeChannel_awaiter(this,void 0,void 0,(function*(){return yield this.send({type:"presence",event:"untrack"},opts)}))}on(type,filter,callback){return this._on(type,filter,callback)}send(payload,opts={}){return new Promise((resolve=>{var _a,_b,_c;const push=this._push(payload.type,payload,opts.timeout||this.timeout);push.rateLimited&&resolve("rate limited"),"broadcast"!==payload.type||(null===(_c=null===(_b=null===(_a=this.params)||void 0===_a?void 0:_a.config)||void 0===_b?void 0:_b.broadcast)||void 0===_c?void 0:_c.ack)||resolve("ok"),push.receive("ok",(()=>resolve("ok"))),push.receive("timeout",(()=>resolve("timed out")))}))}updateJoinPayload(payload){this.joinPush.updatePayload(payload)}unsubscribe(timeout=this.timeout){this.state=CHANNEL_STATES.leaving;const onClose=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((resolve=>{const leavePush=new Push(this,CHANNEL_EVENTS.leave,{},timeout);leavePush.receive("ok",(()=>{onClose(),resolve("ok")})).receive("timeout",(()=>{onClose(),resolve("timed out")})).receive("error",(()=>{resolve("error")})),leavePush.send(),this._canPush()||leavePush.trigger("ok",{})}))}_push(event,payload,timeout=this.timeout){if(!this.joinedOnce)throw`tried to push '${event}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let pushEvent=new Push(this,event,payload,timeout);return this._canPush()?pushEvent.send():(pushEvent.startTimeout(),this.pushBuffer.push(pushEvent)),pushEvent}_onMessage(_event,payload,_ref){return payload}_isMember(topic){return this.topic===topic}_joinRef(){return this.joinPush.ref}_trigger(type,payload,ref){var _a,_b;const typeLower=type.toLocaleLowerCase(),{close,error,leave,join}=CHANNEL_EVENTS;if(ref&&[close,error,leave,join].indexOf(typeLower)>=0&&ref!==this._joinRef())return;let handledPayload=this._onMessage(typeLower,payload,ref);if(payload&&!handledPayload)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(typeLower)?null===(_a=this.bindings.postgres_changes)||void 0===_a||_a.filter((bind=>{var _a,_b,_c;return"*"===(null===(_a=bind.filter)||void 0===_a?void 0:_a.event)||(null===(_c=null===(_b=bind.filter)||void 0===_b?void 0:_b.event)||void 0===_c?void 0:_c.toLocaleLowerCase())===typeLower})).map((bind=>bind.callback(handledPayload,ref))):null===(_b=this.bindings[typeLower])||void 0===_b||_b.filter((bind=>{var _a,_b,_c,_d,_e,_f;if(["broadcast","presence","postgres_changes"].includes(typeLower)){if("id"in bind){const bindId=bind.id,bindEvent=null===(_a=bind.filter)||void 0===_a?void 0:_a.event;return bindId&&(null===(_b=payload.ids)||void 0===_b?void 0:_b.includes(bindId))&&("*"===bindEvent||(null==bindEvent?void 0:bindEvent.toLocaleLowerCase())===(null===(_c=payload.data)||void 0===_c?void 0:_c.type.toLocaleLowerCase()))}{const bindEvent=null===(_e=null===(_d=null==bind?void 0:bind.filter)||void 0===_d?void 0:_d.event)||void 0===_e?void 0:_e.toLocaleLowerCase();return"*"===bindEvent||bindEvent===(null===(_f=null==payload?void 0:payload.event)||void 0===_f?void 0:_f.toLocaleLowerCase())}}return bind.type.toLocaleLowerCase()===typeLower})).map((bind=>{if("object"==typeof handledPayload&&"ids"in handledPayload){const postgresChanges=handledPayload.data,{schema,table,commit_timestamp,type,errors}=postgresChanges,enrichedPayload={schema,table,commit_timestamp,eventType:type,new:{},old:{},errors};handledPayload=Object.assign(Object.assign({},enrichedPayload),this._getPayloadRecords(postgresChanges))}bind.callback(handledPayload,ref)}))}_isClosed(){return this.state===CHANNEL_STATES.closed}_isJoined(){return this.state===CHANNEL_STATES.joined}_isJoining(){return this.state===CHANNEL_STATES.joining}_isLeaving(){return this.state===CHANNEL_STATES.leaving}_replyEventName(ref){return`chan_reply_${ref}`}_on(type,filter,callback){const typeLower=type.toLocaleLowerCase(),binding={type:typeLower,filter,callback};return this.bindings[typeLower]?this.bindings[typeLower].push(binding):this.bindings[typeLower]=[binding],this}_off(type,filter){const typeLower=type.toLocaleLowerCase();return this.bindings[typeLower]=this.bindings[typeLower].filter((bind=>{var _a;return!((null===(_a=bind.type)||void 0===_a?void 0:_a.toLocaleLowerCase())===typeLower&&RealtimeChannel.isEqual(bind.filter,filter))})),this}static isEqual(obj1,obj2){if(Object.keys(obj1).length!==Object.keys(obj2).length)return!1;for(const k in obj1)if(obj1[k]!==obj2[k])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(callback){this._on(CHANNEL_EVENTS.close,{},callback)}_onError(callback){this._on(CHANNEL_EVENTS.error,{},(reason=>callback(reason)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(timeout=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=CHANNEL_STATES.joining,this.joinPush.resend(timeout))}_getPayloadRecords(payload){const records={new:{},old:{}};return"INSERT"!==payload.type&&"UPDATE"!==payload.type||(records.new=convertChangeData(payload.columns,payload.record)),"UPDATE"!==payload.type&&"DELETE"!==payload.type||(records.old=convertChangeData(payload.columns,payload.old_record)),records}}var RealtimeClient_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const RealtimeClient_noop=()=>{};class RealtimeClient{constructor(endPoint,options){var _a;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=constants_DEFAULT_HEADERS,this.params={},this.timeout=1e4,this.transport=browser.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=RealtimeClient_noop,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this.endPoint=`${endPoint}/${TRANSPORTS.websocket}`,(null==options?void 0:options.params)&&(this.params=options.params),(null==options?void 0:options.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),options.headers)),(null==options?void 0:options.timeout)&&(this.timeout=options.timeout),(null==options?void 0:options.logger)&&(this.logger=options.logger),(null==options?void 0:options.transport)&&(this.transport=options.transport),(null==options?void 0:options.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=options.heartbeatIntervalMs);const eventsPerSecond=null===(_a=null==options?void 0:options.params)||void 0===_a?void 0:_a.eventsPerSecond;eventsPerSecond&&(this.eventsPerSecondLimitMs=Math.floor(1e3/eventsPerSecond)),this.reconnectAfterMs=(null==options?void 0:options.reconnectAfterMs)?options.reconnectAfterMs:tries=>[1e3,2e3,5e3,1e4][tries-1]||1e4,this.encode=(null==options?void 0:options.encode)?options.encode:(payload,callback)=>callback(JSON.stringify(payload)),this.decode=(null==options?void 0:options.decode)?options.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Timer((()=>RealtimeClient_awaiter(this,void 0,void 0,(function*(){this.disconnect(),this.connect()}))),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=error=>this._onConnError(error),this.conn.onmessage=event=>this._onConnMessage(event),this.conn.onclose=event=>this._onConnClose(event)))}disconnect(code,reason){this.conn&&(this.conn.onclose=function(){},code?this.conn.close(code,null!=reason?reason:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(channel){return RealtimeClient_awaiter(this,void 0,void 0,(function*(){const status=yield channel.unsubscribe();return 0===this.channels.length&&this.disconnect(),status}))}removeAllChannels(){return RealtimeClient_awaiter(this,void 0,void 0,(function*(){const values_1=yield Promise.all(this.channels.map((channel=>channel.unsubscribe())));return this.disconnect(),values_1}))}log(kind,msg,data){this.logger(kind,msg,data)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}channel(topic,params={config:{}}){this.isConnected()||this.connect();const chan=new RealtimeChannel(`realtime:${topic}`,params,this);return this.channels.push(chan),chan}push(data){const{topic,event,payload,ref}=data;let callback=()=>{this.encode(data,(result=>{var _a;null===(_a=this.conn)||void 0===_a||_a.send(result)}))};if(this.log("push",`${topic} ${event} (${ref})`,payload),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(event)){if(this._throttle(callback)())return"rate limited"}else callback();else this.sendBuffer.push(callback)}setAuth(token){this.accessToken=token,this.channels.forEach((channel=>{token&&channel.updateJoinPayload({access_token:token}),channel.joinedOnce&&channel._isJoined()&&channel._push(CHANNEL_EVENTS.access_token,{access_token:token})}))}_makeRef(){let newRef=this.ref+1;return newRef===this.ref?this.ref=0:this.ref=newRef,this.ref.toString()}_leaveOpenTopic(topic){let dupChannel=this.channels.find((c=>c.topic===topic&&(c._isJoined()||c._isJoining())));dupChannel&&(this.log("transport",`leaving duplicate topic "${topic}"`),dupChannel.unsubscribe())}_remove(channel){this.channels=this.channels.filter((c=>c._joinRef()!==channel._joinRef()))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(rawMessage){this.decode(rawMessage.data,(msg=>{let{topic,event,payload,ref}=msg;(ref&&ref===this.pendingHeartbeatRef||event===(null==payload?void 0:payload.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${payload.status||""} ${topic} ${event} ${ref&&"("+ref+")"||""}`,payload),this.channels.filter((channel=>channel._isMember(topic))).forEach((channel=>channel._trigger(event,payload,ref))),this.stateChangeCallbacks.message.forEach((callback=>callback(msg)))}))}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this._sendHeartbeat()),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach((callback=>callback()))}_onConnClose(event){this.log("transport","close",event),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((callback=>callback(event)))}_onConnError(error){this.log("transport",error.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((callback=>callback(error)))}_triggerChanError(){this.channels.forEach((channel=>channel._trigger(CHANNEL_EVENTS.error)))}_appendParams(url,params){if(0===Object.keys(params).length)return url;const prefix=url.match(/\?/)?"&":"?";return`${url}${prefix}${new URLSearchParams(params)}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((callback=>callback())),this.sendBuffer=[])}_sendHeartbeat(){var _a;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(_a=this.conn)||void 0===_a||_a.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(callback,eventsPerSecondLimitMs=this.eventsPerSecondLimitMs){return()=>!!this.inThrottle||(callback(),eventsPerSecondLimitMs>0&&(this.inThrottle=!0,setTimeout((()=>{this.inThrottle=!1}),eventsPerSecondLimitMs)),!1)}}class StorageError extends Error{constructor(message){super(message),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(error){return"object"==typeof error&&null!==error&&"__isStorageError"in error}class StorageApiError extends StorageError{constructor(message,status){super(message),this.name="StorageApiError",this.status=status}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class StorageUnknownError extends StorageError{constructor(message,originalError){super(message),this.name="StorageUnknownError",this.originalError=originalError}}var helpers_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const helpers_resolveFetch=customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?(...args)=>helpers_awaiter(void 0,void 0,void 0,(function*(){return yield(yield Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/cross-fetch/dist/browser-ponyfill.js",23))).fetch(...args)})):fetch),(...args)=>_fetch(...args)};var fetch_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const _getErrorMessage=err=>err.msg||err.message||err.error_description||err.error||JSON.stringify(err),handleError=(error,reject)=>fetch_awaiter(void 0,void 0,void 0,(function*(){const Res=yield helpers_awaiter(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/cross-fetch/dist/browser-ponyfill.js",23))).Response:Response}));error instanceof Res?error.json().then((err=>{reject(new StorageApiError(_getErrorMessage(err),error.status||500))})).catch((err=>{reject(new StorageUnknownError(_getErrorMessage(err),err))})):reject(new StorageUnknownError(_getErrorMessage(error),error))})),_getRequestParams=(method,options,parameters,body)=>{const params={method,headers:(null==options?void 0:options.headers)||{}};return"GET"===method?params:(params.headers=Object.assign({"Content-Type":"application/json"},null==options?void 0:options.headers),params.body=JSON.stringify(body),Object.assign(Object.assign({},params),parameters))};function _handleRequest(fetcher,method,url,options,parameters,body){return fetch_awaiter(this,void 0,void 0,(function*(){return new Promise(((resolve,reject)=>{fetcher(url,_getRequestParams(method,options,parameters,body)).then((result=>{if(!result.ok)throw result;return(null==options?void 0:options.noResolveJson)?result:result.json()})).then((data=>resolve(data))).catch((error=>handleError(error,reject)))}))}))}function get(fetcher,url,options,parameters){return fetch_awaiter(this,void 0,void 0,(function*(){return _handleRequest(fetcher,"GET",url,options,parameters)}))}function post(fetcher,url,body,options,parameters){return fetch_awaiter(this,void 0,void 0,(function*(){return _handleRequest(fetcher,"POST",url,options,parameters,body)}))}function remove(fetcher,url,body,options,parameters){return fetch_awaiter(this,void 0,void 0,(function*(){return _handleRequest(fetcher,"DELETE",url,options,parameters,body)}))}var StorageFileApi_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(url,headers={},bucketId,fetch){this.url=url,this.headers=headers,this.bucketId=bucketId,this.fetch=helpers_resolveFetch(fetch)}uploadOrUpdate(method,path,fileBody,fileOptions){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{let body;const options=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),fileOptions),headers=Object.assign(Object.assign({},this.headers),"POST"===method&&{"x-upsert":String(options.upsert)});"undefined"!=typeof Blob&&fileBody instanceof Blob?(body=new FormData,body.append("cacheControl",options.cacheControl),body.append("",fileBody)):"undefined"!=typeof FormData&&fileBody instanceof FormData?(body=fileBody,body.append("cacheControl",options.cacheControl)):(body=fileBody,headers["cache-control"]=`max-age=${options.cacheControl}`,headers["content-type"]=options.contentType);const cleanPath=this._removeEmptyFolders(path),_path=this._getFinalPath(cleanPath),res=yield this.fetch(`${this.url}/object/${_path}`,Object.assign({method,body,headers},(null==options?void 0:options.duplex)?{duplex:options.duplex}:{}));if(res.ok)return{data:{path:cleanPath},error:null};return{data:null,error:yield res.json()}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}upload(path,fileBody,fileOptions){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",path,fileBody,fileOptions)}))}uploadToSignedUrl(path,token,fileBody,fileOptions){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){const cleanPath=this._removeEmptyFolders(path),_path=this._getFinalPath(cleanPath),url=new URL(this.url+`/object/upload/sign/${_path}`);url.searchParams.set("token",token);try{let body;const options=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},fileOptions),headers=Object.assign(Object.assign({},this.headers),{"x-upsert":String(options.upsert)});"undefined"!=typeof Blob&&fileBody instanceof Blob?(body=new FormData,body.append("cacheControl",options.cacheControl),body.append("",fileBody)):"undefined"!=typeof FormData&&fileBody instanceof FormData?(body=fileBody,body.append("cacheControl",options.cacheControl)):(body=fileBody,headers["cache-control"]=`max-age=${options.cacheControl}`,headers["content-type"]=options.contentType);const res=yield this.fetch(url.toString(),{method:"PUT",body,headers});if(res.ok)return{data:{path:cleanPath},error:null};return{data:null,error:yield res.json()}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}createSignedUploadUrl(path){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{let _path=this._getFinalPath(path);const data=yield post(this.fetch,`${this.url}/object/upload/sign/${_path}`,{},{headers:this.headers}),url=new URL(this.url+data.url),token=url.searchParams.get("token");if(!token)throw new StorageError("No token returned by API");return{data:{signedUrl:url.toString(),path,token},error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}update(path,fileBody,fileOptions){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",path,fileBody,fileOptions)}))}move(fromPath,toPath){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:fromPath,destinationKey:toPath},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}copy(fromPath,toPath){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:fromPath,destinationKey:toPath},{headers:this.headers})).Key},error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}createSignedUrl(path,expiresIn,options){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{let _path=this._getFinalPath(path),data=yield post(this.fetch,`${this.url}/object/sign/${_path}`,Object.assign({expiresIn},(null==options?void 0:options.transform)?{transform:options.transform}:{}),{headers:this.headers});const downloadQueryParam=(null==options?void 0:options.download)?`&download=${!0===options.download?"":options.download}`:"";return data={signedUrl:encodeURI(`${this.url}${data.signedURL}${downloadQueryParam}`)},{data,error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}createSignedUrls(paths,expiresIn,options){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{const data=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn,paths},{headers:this.headers}),downloadQueryParam=(null==options?void 0:options.download)?`&download=${!0===options.download?"":options.download}`:"";return{data:data.map((datum=>Object.assign(Object.assign({},datum),{signedUrl:datum.signedURL?encodeURI(`${this.url}${datum.signedURL}${downloadQueryParam}`):null}))),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}download(path,options){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){const renderPath=void 0!==(null==options?void 0:options.transform)?"render/image/authenticated":"object",transformationQuery=this.transformOptsToQueryString((null==options?void 0:options.transform)||{}),queryString=transformationQuery?`?${transformationQuery}`:"";try{const _path=this._getFinalPath(path),res=yield get(this.fetch,`${this.url}/${renderPath}/${_path}${queryString}`,{headers:this.headers,noResolveJson:!0});return{data:yield res.blob(),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}getPublicUrl(path,options){const _path=this._getFinalPath(path),_queryString=[],downloadQueryParam=(null==options?void 0:options.download)?`download=${!0===options.download?"":options.download}`:"";""!==downloadQueryParam&&_queryString.push(downloadQueryParam);const renderPath=void 0!==(null==options?void 0:options.transform)?"render/image":"object",transformationQuery=this.transformOptsToQueryString((null==options?void 0:options.transform)||{});""!==transformationQuery&&_queryString.push(transformationQuery);let queryString=_queryString.join("&");return""!==queryString&&(queryString=`?${queryString}`),{data:{publicUrl:encodeURI(`${this.url}/${renderPath}/public/${_path}${queryString}`)}}}remove(paths){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:paths},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}list(path,options,parameters){return StorageFileApi_awaiter(this,void 0,void 0,(function*(){try{const body=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),options),{prefix:path||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,body,{headers:this.headers},parameters),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}_getFinalPath(path){return`${this.bucketId}/${path}`}_removeEmptyFolders(path){return path.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(transform){const params=[];return transform.width&&params.push(`width=${transform.width}`),transform.height&&params.push(`height=${transform.height}`),transform.resize&&params.push(`resize=${transform.resize}`),transform.format&&params.push(`format=${transform.format}`),transform.quality&&params.push(`quality=${transform.quality}`),params.join("&")}}const lib_constants_DEFAULT_HEADERS={"X-Client-Info":"storage-js/2.5.1"};var StorageBucketApi_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};class StorageBucketApi{constructor(url,headers={},fetch){this.url=url,this.headers=Object.assign(Object.assign({},lib_constants_DEFAULT_HEADERS),headers),this.fetch=helpers_resolveFetch(fetch)}listBuckets(){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}getBucket(id){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket/${id}`,{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}createBucket(id,options={public:!1}){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id,name:id,public:options.public,file_size_limit:options.fileSizeLimit,allowed_mime_types:options.allowedMimeTypes},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}updateBucket(id,options){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{const data=yield function put(fetcher,url,body,options,parameters){return fetch_awaiter(this,void 0,void 0,(function*(){return _handleRequest(fetcher,"PUT",url,options,parameters,body)}))}(this.fetch,`${this.url}/bucket/${id}`,{id,name:id,public:options.public,file_size_limit:options.fileSizeLimit,allowed_mime_types:options.allowedMimeTypes},{headers:this.headers});return{data,error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}emptyBucket(id){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${id}/empty`,{},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}deleteBucket(id){return StorageBucketApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${id}`,{},{headers:this.headers}),error:null}}catch(error){if(isStorageError(error))return{data:null,error};throw error}}))}}class StorageClient extends StorageBucketApi{constructor(url,headers={},fetch){super(url,headers,fetch)}from(id){return new StorageFileApi(this.url,this.headers,id,this.fetch)}}const module_lib_constants_DEFAULT_HEADERS={"X-Client-Info":"supabase-js/2.26.0"};var lib_fetch_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const fetch_resolveFetch=customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?browser_ponyfill_default():fetch),(...args)=>_fetch(...args)},fetchWithAuth=(supabaseKey,getAccessToken,customFetch)=>{const fetch=fetch_resolveFetch(customFetch),HeadersConstructor="undefined"==typeof Headers?browser_ponyfill.Headers:Headers;return(input,init)=>lib_fetch_awaiter(void 0,void 0,void 0,(function*(){var _a;const accessToken=null!==(_a=yield getAccessToken())&&void 0!==_a?_a:supabaseKey;let headers=new HeadersConstructor(null==init?void 0:init.headers);return headers.has("apikey")||headers.set("apikey",supabaseKey),headers.has("Authorization")||headers.set("Authorization",`Bearer ${accessToken}`),fetch(input,Object.assign(Object.assign({},init),{headers}))}))};var helpers_console=__webpack_require__("./node_modules/console-browserify/index.js"),lib_helpers_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const helpers_isBrowser=()=>"undefined"!=typeof document,localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!helpers_isBrowser())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const randomKey=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(randomKey,randomKey),globalThis.localStorage.removeItem(randomKey),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch(e){localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function getParameterByName(name,url){var _a;url||(url=(null===(_a=null===window||void 0===window?void 0:window.location)||void 0===_a?void 0:_a.href)||""),name=name.replace(/[\[\]]/g,"\\$&");const results=new RegExp("[?&#]"+name+"(=([^&#]*)|&|#|$)").exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null}const lib_helpers_resolveFetch=customFetch=>{let _fetch;return _fetch=customFetch||("undefined"==typeof fetch?(...args)=>lib_helpers_awaiter(void 0,void 0,void 0,(function*(){return yield(yield Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/cross-fetch/dist/browser-ponyfill.js",23))).fetch(...args)})):fetch),(...args)=>_fetch(...args)},looksLikeFetchResponse=maybeResponse=>"object"==typeof maybeResponse&&null!==maybeResponse&&"status"in maybeResponse&&"ok"in maybeResponse&&"json"in maybeResponse&&"function"==typeof maybeResponse.json,setItemAsync=(storage,key,data)=>lib_helpers_awaiter(void 0,void 0,void 0,(function*(){yield storage.setItem(key,JSON.stringify(data))})),getItemAsync=(storage,key)=>lib_helpers_awaiter(void 0,void 0,void 0,(function*(){const value=yield storage.getItem(key);if(!value)return null;try{return JSON.parse(value)}catch(_a){return value}})),removeItemAsync=(storage,key)=>lib_helpers_awaiter(void 0,void 0,void 0,(function*(){yield storage.removeItem(key)}));class Deferred{constructor(){this.promise=new Deferred.promiseConstructor(((res,rej)=>{this.resolve=res,this.reject=rej}))}}function decodeJWTPayload(token){const parts=token.split(".");if(3!==parts.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(parts[1]))throw new Error("JWT is not valid: payload is not in base64url format");const base64Url=parts[1];return JSON.parse(function helpers_decodeBase64URL(value){const key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let chr1,chr2,chr3,enc1,enc2,enc3,enc4,base64="",i=0;for(value=value.replace("-","+").replace("_","/");i<value.length;)enc1=key.indexOf(value.charAt(i++)),enc2=key.indexOf(value.charAt(i++)),enc3=key.indexOf(value.charAt(i++)),enc4=key.indexOf(value.charAt(i++)),chr1=enc1<<2|enc2>>4,chr2=(15&enc2)<<4|enc3>>2,chr3=(3&enc3)<<6|enc4,base64+=String.fromCharCode(chr1),64!=enc3&&0!=chr2&&(base64+=String.fromCharCode(chr2)),64!=enc4&&0!=chr3&&(base64+=String.fromCharCode(chr3));return base64}(base64Url))}function dec2hex(dec){return("0"+dec.toString(16)).substr(-2)}function generatePKCEVerifier(){const array=new Uint32Array(56);if("undefined"==typeof crypto){const charSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",charSetLen=charSet.length;let verifier="";for(let i=0;i<56;i++)verifier+=charSet.charAt(Math.floor(Math.random()*charSetLen));return verifier}return crypto.getRandomValues(array),Array.from(array,dec2hex).join("")}function generatePKCEChallenge(verifier){return lib_helpers_awaiter(this,void 0,void 0,(function*(){if("undefined"==typeof crypto)return helpers_console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),verifier;return function base64urlencode(str){return btoa(str).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(yield function sha256(randomString){return lib_helpers_awaiter(this,void 0,void 0,(function*(){const encodedData=(new TextEncoder).encode(randomString),hash=yield crypto.subtle.digest("SHA-256",encodedData),bytes=new Uint8Array(hash);return Array.from(bytes).map((c=>String.fromCharCode(c))).join("")}))}(verifier))}))}Deferred.promiseConstructor=Promise;class AuthError extends Error{constructor(message,status){super(message),this.__isAuthError=!0,this.name="AuthError",this.status=status}}function isAuthError(error){return"object"==typeof error&&null!==error&&"__isAuthError"in error}class AuthApiError extends AuthError{constructor(message,status){super(message,status),this.name="AuthApiError",this.status=status}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class AuthUnknownError extends AuthError{constructor(message,originalError){super(message),this.name="AuthUnknownError",this.originalError=originalError}}class CustomAuthError extends AuthError{constructor(message,name,status){super(message),this.name=name,this.status=status}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(message){super(message,"AuthInvalidCredentialsError",400)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(message,details=null){super(message,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=details}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(message,details=null){super(message,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=details}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(message,status){super(message,"AuthRetryableFetchError",status)}}function isAuthRetryableFetchError(error){return isAuthError(error)&&"AuthRetryableFetchError"===error.name}var fetch_console=__webpack_require__("./node_modules/console-browserify/index.js"),module_lib_fetch_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};const fetch_getErrorMessage=err=>err.msg||err.message||err.error_description||err.error||JSON.stringify(err),NETWORK_ERROR_CODES=[502,503,504];function fetch_handleError(error){return module_lib_fetch_awaiter(this,void 0,void 0,(function*(){if(!looksLikeFetchResponse(error))throw new AuthRetryableFetchError(fetch_getErrorMessage(error),0);if(NETWORK_ERROR_CODES.includes(error.status))throw new AuthRetryableFetchError(fetch_getErrorMessage(error),error.status);let data;try{data=yield error.json()}catch(e){throw new AuthUnknownError(fetch_getErrorMessage(e),e)}throw new AuthApiError(fetch_getErrorMessage(data),error.status||500)}))}const fetch_getRequestParams=(method,options,parameters,body)=>{const params={method,headers:(null==options?void 0:options.headers)||{}};return"GET"===method?params:(params.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==options?void 0:options.headers),params.body=JSON.stringify(body),Object.assign(Object.assign({},params),parameters))};function _request(fetcher,method,url,options){var _a;return module_lib_fetch_awaiter(this,void 0,void 0,(function*(){const headers=Object.assign({},null==options?void 0:options.headers);(null==options?void 0:options.jwt)&&(headers.Authorization=`Bearer ${options.jwt}`);const qs=null!==(_a=null==options?void 0:options.query)&&void 0!==_a?_a:{};(null==options?void 0:options.redirectTo)&&(qs.redirect_to=options.redirectTo);const queryString=Object.keys(qs).length?"?"+new URLSearchParams(qs).toString():"",data=yield function fetch_handleRequest(fetcher,method,url,options,parameters,body){return module_lib_fetch_awaiter(this,void 0,void 0,(function*(){const requestParams=fetch_getRequestParams(method,options,parameters,body);let result;try{result=yield fetcher(url,requestParams)}catch(e){throw fetch_console.error(e),new AuthRetryableFetchError(fetch_getErrorMessage(e),0)}if(result.ok||(yield fetch_handleError(result)),null==options?void 0:options.noResolveJson)return result;try{return yield result.json()}catch(e){yield fetch_handleError(e)}}))}(fetcher,method,url+queryString,{headers,noResolveJson:null==options?void 0:options.noResolveJson},{},null==options?void 0:options.body);return(null==options?void 0:options.xform)?null==options?void 0:options.xform(data):{data:Object.assign({},data),error:null}}))}function _sessionResponse(data){var _a;let session=null;(function hasSession(data){return data.access_token&&data.refresh_token&&data.expires_in})(data)&&(session=Object.assign({},data),session.expires_at=function expiresAt(expiresIn){return Math.round(Date.now()/1e3)+expiresIn}(data.expires_in));return{data:{session,user:null!==(_a=data.user)&&void 0!==_a?_a:data},error:null}}function _userResponse(data){var _a;return{data:{user:null!==(_a=data.user)&&void 0!==_a?_a:data},error:null}}function _ssoResponse(data){return{data,error:null}}function _generateLinkResponse(data){const{action_link,email_otp,hashed_token,redirect_to,verification_type}=data,rest=__rest(data,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link,email_otp,hashed_token,redirect_to,verification_type},user:Object.assign({},rest)},error:null}}function _noResolveJsonResponse(data){return data}var GoTrueAdminApi_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},GoTrueAdminApi_rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};class GoTrueAdminApi{constructor({url="",headers={},fetch}){this.url=url,this.headers=headers,this.fetch=lib_helpers_resolveFetch(fetch),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(jwt,scope="global"){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{return yield _request(this.fetch,"POST",`${this.url}/logout?scope=${scope}`,{headers:this.headers,jwt,noResolveJson:!0}),{data:null,error:null}}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}inviteUserByEmail(email,options={}){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{return yield _request(this.fetch,"POST",`${this.url}/invite`,{body:{email,data:options.data},headers:this.headers,redirectTo:options.redirectTo,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}))}generateLink(params){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{const{options}=params,rest=GoTrueAdminApi_rest(params,["options"]),body=Object.assign(Object.assign({},rest),options);return"newEmail"in rest&&(body.new_email=null==rest?void 0:rest.newEmail,delete body.newEmail),yield _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body,headers:this.headers,xform:_generateLinkResponse,redirectTo:null==options?void 0:options.redirectTo})}catch(error){if(isAuthError(error))return{data:{properties:null,user:null},error};throw error}}))}createUser(attributes){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{return yield _request(this.fetch,"POST",`${this.url}/admin/users`,{body:attributes,headers:this.headers,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}))}listUsers(params){var _a,_b,_c,_d,_e,_f,_g;return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{const pagination={nextPage:null,lastPage:0,total:0},response=yield _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(_b=null===(_a=null==params?void 0:params.page)||void 0===_a?void 0:_a.toString())&&void 0!==_b?_b:"",per_page:null!==(_d=null===(_c=null==params?void 0:params.perPage)||void 0===_c?void 0:_c.toString())&&void 0!==_d?_d:""},xform:_noResolveJsonResponse});if(response.error)throw response.error;const users=yield response.json(),total=null!==(_e=response.headers.get("x-total-count"))&&void 0!==_e?_e:0,links=null!==(_g=null===(_f=response.headers.get("link"))||void 0===_f?void 0:_f.split(","))&&void 0!==_g?_g:[];return links.length>0&&(links.forEach((link=>{const page=parseInt(link.split(";")[0].split("=")[1].substring(0,1)),rel=JSON.parse(link.split(";")[1].split("=")[1]);pagination[`${rel}Page`]=page})),pagination.total=parseInt(total)),{data:Object.assign(Object.assign({},users),pagination),error:null}}catch(error){if(isAuthError(error))return{data:{users:[]},error};throw error}}))}getUserById(uid){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{return yield _request(this.fetch,"GET",`${this.url}/admin/users/${uid}`,{headers:this.headers,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}))}updateUserById(uid,attributes){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{return yield _request(this.fetch,"PUT",`${this.url}/admin/users/${uid}`,{body:attributes,headers:this.headers,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}))}deleteUser(id,shouldSoftDelete=!1){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{return yield _request(this.fetch,"DELETE",`${this.url}/admin/users/${id}`,{headers:this.headers,body:{should_soft_delete:shouldSoftDelete},xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}))}_listFactors(params){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{const{data,error}=yield _request(this.fetch,"GET",`${this.url}/admin/users/${params.userId}/factors`,{headers:this.headers,xform:factors=>({data:{factors},error:null})});return{data,error}}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}_deleteFactor(params){return GoTrueAdminApi_awaiter(this,void 0,void 0,(function*(){try{return{data:yield _request(this.fetch,"DELETE",`${this.url}/admin/users/${params.userId}/factors/${params.id}`,{headers:this.headers}),error:null}}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}}const dist_module_lib_constants_DEFAULT_HEADERS={"X-Client-Info":"gotrue-js/2.39.0"},local_storage={getItem:key=>supportsLocalStorage()?globalThis.localStorage.getItem(key):null,setItem:(key,value)=>{supportsLocalStorage()&&globalThis.localStorage.setItem(key,value)},removeItem:key=>{supportsLocalStorage()&&globalThis.localStorage.removeItem(key)}};var GoTrueClient_console=__webpack_require__("./node_modules/console-browserify/index.js"),GoTrueClient_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};!function polyfillGlobalThis(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const DEFAULT_OPTIONS={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:dist_module_lib_constants_DEFAULT_HEADERS,flowType:"implicit",debug:!1};class GoTrueClient{constructor(options){var _a;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&helpers_isBrowser()&&GoTrueClient_console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const settings=Object.assign(Object.assign({},DEFAULT_OPTIONS),options);if(this.logDebugMessages=settings.debug,this.inMemorySession=null,this.storageKey=settings.storageKey,this.autoRefreshToken=settings.autoRefreshToken,this.persistSession=settings.persistSession,this.storage=settings.storage||local_storage,this.admin=new GoTrueAdminApi({url:settings.url,headers:settings.headers,fetch:settings.fetch}),this.url=settings.url,this.headers=settings.headers,this.fetch=lib_helpers_resolveFetch(settings.fetch),this.detectSessionInUrl=settings.detectSessionInUrl,this.flowType=settings.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession&&this.storage===local_storage&&!supportsLocalStorage()&&GoTrueClient_console.warn("No storage option exists to persist the session, which may result in unexpected behavior when using auth.\n        If you want to set persistSession to true, please provide a storage option or you may set persistSession to false to disable this warning."),helpers_isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){GoTrueClient_console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(_a=this.broadcastChannel)||void 0===_a||_a.addEventListener("message",(event=>GoTrueClient_awaiter(this,void 0,void 0,(function*(){this._debug("received broadcast notification from other tab or client",event),yield this._notifyAllSubscribers(event.data.event,event.data.session,!1)}))))}this.initialize()}_debug(...args){return this.logDebugMessages&&GoTrueClient_console.log(`GoTrueClient@${this.instanceID} ${(new Date).toISOString()}`,...args),this}initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}_initialize(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){if(this.initializePromise)return this.initializePromise;try{const isPKCEFlow=!!helpers_isBrowser()&&(yield this._isPKCEFlow());if(this._debug("#_initialize()","begin","is PKCE flow",isPKCEFlow),isPKCEFlow||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data,error}=yield this._getSessionFromUrl(isPKCEFlow);if(error)return this._debug("#_initialize()","error detecting session from URL",error),yield this._removeSession(),{error};const{session,redirectType}=data;return this._debug("#_initialize()","detected session in URL",session,"redirect type",redirectType),yield this._saveSession(session),setTimeout((()=>GoTrueClient_awaiter(this,void 0,void 0,(function*(){"recovery"===redirectType?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",session):yield this._notifyAllSubscribers("SIGNED_IN",session)}))),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(error){return isAuthError(error)?{error}:{error:new AuthUnknownError("Unexpected error during initialization",error)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}}))}signUp(credentials){var _a,_b,_c;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{let res;if(yield this._removeSession(),"email"in credentials){const{email,password,options}=credentials;let codeChallenge=null,codeChallengeMethod=null;if("pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();yield setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier),codeChallenge=yield generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256"}res=yield _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==options?void 0:options.emailRedirectTo,body:{email,password,data:null!==(_a=null==options?void 0:options.data)&&void 0!==_a?_a:{},gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken},code_challenge:codeChallenge,code_challenge_method:codeChallengeMethod},xform:_sessionResponse})}else{if(!("phone"in credentials))throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");{const{phone,password,options}=credentials;res=yield _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone,password,data:null!==(_b=null==options?void 0:options.data)&&void 0!==_b?_b:{},channel:null!==(_c=null==options?void 0:options.channel)&&void 0!==_c?_c:"sms",gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},xform:_sessionResponse})}}const{data,error}=res;if(error||!data)return{data:{user:null,session:null},error};const session=data.session,user=data.user;return data.session&&(yield this._saveSession(data.session),yield this._notifyAllSubscribers("SIGNED_IN",session)),{data:{user,session},error:null}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}))}signInWithPassword(credentials){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{let res;if(yield this._removeSession(),"email"in credentials){const{email,password,options}=credentials;res=yield _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email,password,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},xform:_sessionResponse})}else{if(!("phone"in credentials))throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");{const{phone,password,options}=credentials;res=yield _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone,password,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},xform:_sessionResponse})}}const{data,error}=res;return error?{data:{user:null,session:null},error}:data&&data.session&&data.user?(data.session&&(yield this._saveSession(data.session),yield this._notifyAllSubscribers("SIGNED_IN",data.session)),{data:{user:data.user,session:data.session},error}):{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}))}signInWithOAuth(credentials){var _a,_b,_c,_d;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){return yield this._removeSession(),yield this._handleProviderSignIn(credentials.provider,{redirectTo:null===(_a=credentials.options)||void 0===_a?void 0:_a.redirectTo,scopes:null===(_b=credentials.options)||void 0===_b?void 0:_b.scopes,queryParams:null===(_c=credentials.options)||void 0===_c?void 0:_c.queryParams,skipBrowserRedirect:null===(_d=credentials.options)||void 0===_d?void 0:_d.skipBrowserRedirect})}))}exchangeCodeForSession(authCode){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const codeVerifier=yield getItemAsync(this.storage,`${this.storageKey}-code-verifier`),{data,error}=yield _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:authCode,code_verifier:codeVerifier},xform:_sessionResponse});return yield removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),error?{data:{user:null,session:null},error}:data&&data.session&&data.user?(data.session&&(yield this._saveSession(data.session),yield this._notifyAllSubscribers("SIGNED_IN",data.session)),{data,error}):{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}}))}signInWithIdToken(credentials){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){yield this._removeSession();try{const{options,provider,token,access_token,nonce}=credentials,res=yield _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider,id_token:token,access_token,nonce,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}},xform:_sessionResponse}),{data,error}=res;return error?{data:{user:null,session:null},error}:data&&data.session&&data.user?(data.session&&(yield this._saveSession(data.session),yield this._notifyAllSubscribers("SIGNED_IN",data.session)),{data,error}):{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}))}signInWithOtp(credentials){var _a,_b,_c,_d,_e;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{if(yield this._removeSession(),"email"in credentials){const{email,options}=credentials;let codeChallenge=null,codeChallengeMethod=null;if("pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();yield setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier),codeChallenge=yield generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256"}const{error}=yield _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email,data:null!==(_a=null==options?void 0:options.data)&&void 0!==_a?_a:{},create_user:null===(_b=null==options?void 0:options.shouldCreateUser)||void 0===_b||_b,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken},code_challenge:codeChallenge,code_challenge_method:codeChallengeMethod},redirectTo:null==options?void 0:options.emailRedirectTo});return{data:{user:null,session:null},error}}if("phone"in credentials){const{phone,options}=credentials,{data,error}=yield _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone,data:null!==(_c=null==options?void 0:options.data)&&void 0!==_c?_c:{},create_user:null===(_d=null==options?void 0:options.shouldCreateUser)||void 0===_d||_d,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken},channel:null!==(_e=null==options?void 0:options.channel)&&void 0!==_e?_e:"sms"}});return{data:{user:null,session:null,messageId:null==data?void 0:data.message_id},error}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}))}verifyOtp(params){var _a,_b;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{"email_change"!==params.type&&"phone_change"!==params.type&&(yield this._removeSession());const{data,error}=yield _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},params),{gotrue_meta_security:{captcha_token:null===(_a=params.options)||void 0===_a?void 0:_a.captchaToken}}),redirectTo:null===(_b=params.options)||void 0===_b?void 0:_b.redirectTo,xform:_sessionResponse});if(error)throw error;if(!data)throw new Error("An error occurred on token verification.");const session=data.session,user=data.user;return(null==session?void 0:session.access_token)&&(yield this._saveSession(session),yield this._notifyAllSubscribers("SIGNED_IN",session)),{data:{user,session},error:null}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}))}signInWithSSO(params){var _a,_b,_c;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{return yield this._removeSession(),yield _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in params?{provider_id:params.providerId}:null),"domain"in params?{domain:params.domain}:null),{redirect_to:null!==(_b=null===(_a=params.options)||void 0===_a?void 0:_a.redirectTo)&&void 0!==_b?_b:void 0}),(null===(_c=null==params?void 0:params.options)||void 0===_c?void 0:_c.captchaToken)?{gotrue_meta_security:{captcha_token:params.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:_ssoResponse})}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}reauthenticate(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{const{data:{session},error:sessionError}=yield this.getSession();if(sessionError)throw sessionError;if(!session)throw new AuthSessionMissingError;const{error}=yield _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:session.access_token});return{data:{user:null,session:null},error}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}))}resend(credentials){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{yield this._removeSession();const endpoint=`${this.url}/resend`;if("email"in credentials){const{email,type,options}=credentials,{error}=yield _request(this.fetch,"POST",endpoint,{headers:this.headers,body:{email,type,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}}});return{data:{user:null,session:null},error}}if("phone"in credentials){const{phone,type,options}=credentials,{data,error}=yield _request(this.fetch,"POST",endpoint,{headers:this.headers,body:{phone,type,gotrue_meta_security:{captcha_token:null==options?void 0:options.captchaToken}}});return{data:{user:null,session:null,messageId:null==data?void 0:data.message_id},error}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}))}getSession(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){yield this.initializePromise,this._debug("#getSession()","begin");try{let currentSession=null;if(this.persistSession){const maybeSession=yield getItemAsync(this.storage,this.storageKey);this._debug("#getSession()","session from storage",maybeSession),null!==maybeSession&&(this._isValidSession(maybeSession)?currentSession=maybeSession:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession()))}else currentSession=this.inMemorySession,this._debug("#getSession()","session from memory",currentSession);if(!currentSession)return{data:{session:null},error:null};const hasExpired=!!currentSession.expires_at&&currentSession.expires_at<=Date.now()/1e3;if(this._debug("#getSession()",`session has${hasExpired?"":" not"} expired`,"expires_at",currentSession.expires_at),!hasExpired)return{data:{session:currentSession},error:null};const{session,error}=yield this._callRefreshToken(currentSession.refresh_token);return error?{data:{session:null},error}:{data:{session},error:null}}finally{this._debug("#getSession()","end")}}))}getUser(jwt){var _a,_b;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{if(!jwt){const{data,error}=yield this.getSession();if(error)throw error;jwt=null!==(_b=null===(_a=data.session)||void 0===_a?void 0:_a.access_token)&&void 0!==_b?_b:void 0}return yield _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt,xform:_userResponse})}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}))}updateUser(attributes,options={}){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{const{data:sessionData,error:sessionError}=yield this.getSession();if(sessionError)throw sessionError;if(!sessionData.session)throw new AuthSessionMissingError;const session=sessionData.session,{data,error:userError}=yield _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==options?void 0:options.emailRedirectTo,body:attributes,jwt:session.access_token,xform:_userResponse});if(userError)throw userError;return session.user=data.user,yield this._saveSession(session),yield this._notifyAllSubscribers("USER_UPDATED",session),{data:{user:session.user},error:null}}catch(error){if(isAuthError(error))return{data:{user:null},error};throw error}}))}_decodeJWT(jwt){return decodeJWTPayload(jwt)}setSession(currentSession){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{if(!currentSession.access_token||!currentSession.refresh_token)throw new AuthSessionMissingError;const timeNow=Date.now()/1e3;let expiresAt=timeNow,hasExpired=!0,session=null;const payload=decodeJWTPayload(currentSession.access_token);if(payload.exp&&(expiresAt=payload.exp,hasExpired=expiresAt<=timeNow),hasExpired){const{session:refreshedSession,error}=yield this._callRefreshToken(currentSession.refresh_token);if(error)return{data:{user:null,session:null},error};if(!refreshedSession)return{data:{user:null,session:null},error:null};session=refreshedSession}else{const{data,error}=yield this.getUser(currentSession.access_token);if(error)throw error;session={access_token:currentSession.access_token,refresh_token:currentSession.refresh_token,user:data.user,token_type:"bearer",expires_in:expiresAt-timeNow,expires_at:expiresAt},yield this._saveSession(session),yield this._notifyAllSubscribers("SIGNED_IN",session)}return{data:{user:session.user,session},error:null}}catch(error){if(isAuthError(error))return{data:{session:null,user:null},error};throw error}}))}refreshSession(currentSession){var _a;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{if(!currentSession){const{data,error}=yield this.getSession();if(error)throw error;currentSession=null!==(_a=data.session)&&void 0!==_a?_a:void 0}if(!(null==currentSession?void 0:currentSession.refresh_token))throw new AuthSessionMissingError;const{session,error}=yield this._callRefreshToken(currentSession.refresh_token);return error?{data:{user:null,session:null},error}:session?{data:{user:session.user,session},error:null}:{data:{user:null,session:null},error:null}}catch(error){if(isAuthError(error))return{data:{user:null,session:null},error};throw error}}))}_getSessionFromUrl(isPKCEFlow){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{if(!helpers_isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if("implicit"===this.flowType&&!this._isImplicitGrantFlow())throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");if("pkce"==this.flowType&&!isPKCEFlow)throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");if(isPKCEFlow){const authCode=getParameterByName("code");if(!authCode)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data,error}=yield this.exchangeCodeForSession(authCode);if(error)throw error;if(!data.session)throw new AuthPKCEGrantCodeExchangeError("No session detected.");let url=new URL(window.location.href);return url.searchParams.delete("code"),window.history.replaceState(window.history.state,"",url.toString()),{data:{session:data.session,redirectType:null},error:null}}const error_description=getParameterByName("error_description");if(error_description){const error_code=getParameterByName("error_code");if(!error_code)throw new AuthImplicitGrantRedirectError("No error_code detected.");const error=getParameterByName("error");if(!error)throw new AuthImplicitGrantRedirectError("No error detected.");throw new AuthImplicitGrantRedirectError(error_description,{error,code:error_code})}const provider_token=getParameterByName("provider_token"),provider_refresh_token=getParameterByName("provider_refresh_token"),access_token=getParameterByName("access_token");if(!access_token)throw new AuthImplicitGrantRedirectError("No access_token detected.");const expires_in=getParameterByName("expires_in");if(!expires_in)throw new AuthImplicitGrantRedirectError("No expires_in detected.");const refresh_token=getParameterByName("refresh_token");if(!refresh_token)throw new AuthImplicitGrantRedirectError("No refresh_token detected.");const token_type=getParameterByName("token_type");if(!token_type)throw new AuthImplicitGrantRedirectError("No token_type detected.");const expires_at=Math.round(Date.now()/1e3)+parseInt(expires_in),{data,error}=yield this.getUser(access_token);if(error)throw error;const user=data.user,session={provider_token,provider_refresh_token,access_token,expires_in:parseInt(expires_in),expires_at,refresh_token,token_type,user},redirectType=getParameterByName("type");return window.location.hash="",this._debug("#_getSessionFromUrl()","clearing window.location.hash"),{data:{session,redirectType},error:null}}catch(error){if(isAuthError(error))return{data:{session:null,redirectType:null},error};throw error}}))}_isImplicitGrantFlow(){return helpers_isBrowser()&&(Boolean(getParameterByName("access_token"))||Boolean(getParameterByName("error_description")))}_isPKCEFlow(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const currentStorageContent=yield getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return Boolean(getParameterByName("code"))&&Boolean(currentStorageContent)}))}signOut({scope}={scope:"global"}){var _a;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const{data,error:sessionError}=yield this.getSession();if(sessionError)return{error:sessionError};const accessToken=null===(_a=data.session)||void 0===_a?void 0:_a.access_token;if(accessToken){const{error}=yield this.admin.signOut(accessToken,scope);if(error&&(!function isAuthApiError(error){return isAuthError(error)&&"AuthApiError"===error.name}(error)||404!==error.status&&401!==error.status))return{error}}return"others"!==scope&&(yield this._removeSession(),yield removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),yield this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}}))}onAuthStateChange(callback){const id=function helpers_uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(c){const r=16*Math.random()|0;return("x"==c?r:3&r|8).toString(16)}))}(),subscription={id,callback,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",id),this.stateChangeEmitters.delete(id)}};return this._debug("#onAuthStateChange()","registered callback with id",id),this.stateChangeEmitters.set(id,subscription),this._emitInitialSession(id),{data:{subscription}}}_emitInitialSession(id){var _a,_b;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{const{data:{session},error}=yield this.getSession();if(error)throw error;yield null===(_a=this.stateChangeEmitters.get(id))||void 0===_a?void 0:_a.callback("INITIAL_SESSION",session),this._debug("INITIAL_SESSION","callback id",id,"session",session)}catch(err){yield null===(_b=this.stateChangeEmitters.get(id))||void 0===_b?void 0:_b.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",id,"error",err),GoTrueClient_console.error(err)}}))}resetPasswordForEmail(email,options={}){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){let codeChallenge=null,codeChallengeMethod=null;if("pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();yield setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier),codeChallenge=yield generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256"}try{return yield _request(this.fetch,"POST",`${this.url}/recover`,{body:{email,code_challenge:codeChallenge,code_challenge_method:codeChallengeMethod,gotrue_meta_security:{captcha_token:options.captchaToken}},headers:this.headers,redirectTo:options.redirectTo})}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}_refreshAccessToken(refreshToken){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const debugName=`#_refreshAccessToken(${refreshToken.substring(0,5)}...)`;this._debug(debugName,"begin");try{const startedAt=Date.now();return yield function retryable(fn,isRetryable){return new Promise(((accept,reject)=>{(()=>{lib_helpers_awaiter(this,void 0,void 0,(function*(){for(let attempt=0;attempt<1/0;attempt++)try{const result=yield fn(attempt);if(!isRetryable(attempt,null,result))return void accept(result)}catch(e){if(!isRetryable(attempt,e))return void reject(e)}}))})()}))}((attempt=>GoTrueClient_awaiter(this,void 0,void 0,(function*(){return yield function sleep(time){return new Promise((accept=>{setTimeout((()=>accept(null)),time)}))}(200*attempt),this._debug(debugName,"refreshing attempt",attempt),yield _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:refreshToken},headers:this.headers,xform:_sessionResponse})}))),((attempt,_,result)=>result&&result.error&&isAuthRetryableFetchError(result.error)&&Date.now()+200*(attempt+1)-startedAt<3e4))}catch(error){if(this._debug(debugName,"error",error),isAuthError(error))return{data:{session:null,user:null},error};throw error}finally{this._debug(debugName,"end")}}))}_isValidSession(maybeSession){return"object"==typeof maybeSession&&null!==maybeSession&&"access_token"in maybeSession&&"refresh_token"in maybeSession&&"expires_at"in maybeSession}_handleProviderSignIn(provider,options){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const url=yield this._getUrlForProvider(provider,{redirectTo:options.redirectTo,scopes:options.scopes,queryParams:options.queryParams});return this._debug("#_handleProviderSignIn()","provider",provider,"options",options,"url",url),helpers_isBrowser()&&!options.skipBrowserRedirect&&window.location.assign(url),{data:{provider,url},error:null}}))}_recoverAndRefresh(){var _a;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const debugName="#_recoverAndRefresh()";this._debug(debugName,"begin");try{const currentSession=yield getItemAsync(this.storage,this.storageKey);if(this._debug(debugName,"session from storage",currentSession),!this._isValidSession(currentSession))return this._debug(debugName,"session is not valid"),void(null!==currentSession&&(yield this._removeSession()));const timeNow=Math.round(Date.now()/1e3),expiresWithMargin=(null!==(_a=currentSession.expires_at)&&void 0!==_a?_a:1/0)<timeNow+10;if(this._debug(debugName,`session has${expiresWithMargin?"":" not"} expired with margin of 10s`),expiresWithMargin){if(this.autoRefreshToken&&currentSession.refresh_token){const{error}=yield this._callRefreshToken(currentSession.refresh_token);error&&(GoTrueClient_console.error(error),isAuthRetryableFetchError(error)||(this._debug(debugName,"refresh failed with a non-retryable error, removing the session",error),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",currentSession)}catch(err){return this._debug(debugName,"error",err),void GoTrueClient_console.error(err)}finally{this._debug(debugName,"end")}}))}_callRefreshToken(refreshToken){var _a,_b;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){if(!refreshToken)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const debugName=`#_callRefreshToken(${refreshToken.substring(0,5)}...)`;this._debug(debugName,"begin");try{this.refreshingDeferred=new Deferred;const{data,error}=yield this._refreshAccessToken(refreshToken);if(error)throw error;if(!data.session)throw new AuthSessionMissingError;yield this._saveSession(data.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",data.session);const result={session:data.session,error:null};return this.refreshingDeferred.resolve(result),result}catch(error){if(this._debug(debugName,"error",error),isAuthError(error)){const result={session:null,error};return null===(_a=this.refreshingDeferred)||void 0===_a||_a.resolve(result),result}throw null===(_b=this.refreshingDeferred)||void 0===_b||_b.reject(error),error}finally{this.refreshingDeferred=null,this._debug(debugName,"end")}}))}_notifyAllSubscribers(event,session,broadcast=!0){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const debugName=`#_notifyAllSubscribers(${event})`;this._debug(debugName,"begin",session,`broadcast = ${broadcast}`);try{this.broadcastChannel&&broadcast&&this.broadcastChannel.postMessage({event,session});const errors=[],promises=Array.from(this.stateChangeEmitters.values()).map((x=>GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{yield x.callback(event,session)}catch(e){errors.push(e)}}))));if(yield Promise.all(promises),errors.length>0){for(let i=0;i<errors.length;i+=1)GoTrueClient_console.error(errors[i]);throw errors[0]}}finally{this._debug(debugName,"end")}}))}_saveSession(session){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){this._debug("#_saveSession()",session),this.persistSession||(this.inMemorySession=session),this.persistSession&&session.expires_at&&(yield this._persistSession(session))}))}_persistSession(currentSession){return this._debug("#_persistSession()",currentSession),setItemAsync(this.storage,this.storageKey,currentSession)}_removeSession(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){this._debug("#_removeSession()"),this.persistSession?yield removeItemAsync(this.storage,this.storageKey):this.inMemorySession=null}))}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const callback=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{callback&&helpers_isBrowser()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",callback)}catch(e){GoTrueClient_console.error("removing visibilitychange callback failed",e)}}_startAutoRefresh(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const ticker=setInterval((()=>this._autoRefreshTokenTick()),3e4);this.autoRefreshTicker=ticker,ticker&&"object"==typeof ticker&&"function"==typeof ticker.unref?ticker.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(ticker),yield this._autoRefreshTokenTick()}))}_stopAutoRefresh(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){this._debug("#_stopAutoRefresh()");const ticker=this.autoRefreshTicker;this.autoRefreshTicker=null,ticker&&clearInterval(ticker)}))}startAutoRefresh(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()}))}stopAutoRefresh(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()}))}_autoRefreshTokenTick(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){this._debug("#_autoRefreshTokenTick()","begin");try{const now=Date.now();try{const{data:{session}}=yield this.getSession();if(!session||!session.refresh_token||!session.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const expiresInTicks=Math.floor((1e3*session.expires_at-now)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${expiresInTicks} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),expiresInTicks<=3&&(yield this._callRefreshToken(session.refresh_token))}catch(e){GoTrueClient_console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}_handleVisibilityChange(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){if(this._debug("#_handleVisibilityChange()"),!helpers_isBrowser()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>GoTrueClient_awaiter(this,void 0,void 0,(function*(){return yield this._onVisibilityChanged(!1)})),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(error){GoTrueClient_console.error("_handleVisibilityChange",error)}}))}_onVisibilityChanged(isInitial){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){this._debug(`#_onVisibilityChanged(${isInitial})`,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(isInitial||(yield this.initializePromise,yield this._recoverAndRefresh(),this._debug("#_onVisibilityChanged()","finished waiting for initialize, _recoverAndRefresh")),this.autoRefreshToken&&this._startAutoRefresh()):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}))}_getUrlForProvider(provider,options){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const urlParams=[`provider=${encodeURIComponent(provider)}`];if((null==options?void 0:options.redirectTo)&&urlParams.push(`redirect_to=${encodeURIComponent(options.redirectTo)}`),(null==options?void 0:options.scopes)&&urlParams.push(`scopes=${encodeURIComponent(options.scopes)}`),"pkce"===this.flowType){const codeVerifier=generatePKCEVerifier();yield setItemAsync(this.storage,`${this.storageKey}-code-verifier`,codeVerifier);const codeChallenge=yield generatePKCEChallenge(codeVerifier),codeChallengeMethod=codeVerifier===codeChallenge?"plain":"s256";this._debug("PKCE","code verifier",`${codeVerifier.substring(0,5)}...`,"code challenge",codeChallenge,"method",codeChallengeMethod);const flowParams=new URLSearchParams({code_challenge:`${encodeURIComponent(codeChallenge)}`,code_challenge_method:`${encodeURIComponent(codeChallengeMethod)}`});urlParams.push(flowParams.toString())}if(null==options?void 0:options.queryParams){const query=new URLSearchParams(options.queryParams);urlParams.push(query.toString())}return`${this.url}/authorize?${urlParams.join("&")}`}))}_unenroll(params){var _a;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{const{data:sessionData,error:sessionError}=yield this.getSession();return sessionError?{data:null,error:sessionError}:yield _request(this.fetch,"DELETE",`${this.url}/factors/${params.factorId}`,{headers:this.headers,jwt:null===(_a=null==sessionData?void 0:sessionData.session)||void 0===_a?void 0:_a.access_token})}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}_enroll(params){var _a,_b;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{const{data:sessionData,error:sessionError}=yield this.getSession();if(sessionError)return{data:null,error:sessionError};const{data,error}=yield _request(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:params.friendlyName,factor_type:params.factorType,issuer:params.issuer},headers:this.headers,jwt:null===(_a=null==sessionData?void 0:sessionData.session)||void 0===_a?void 0:_a.access_token});return error?{data:null,error}:((null===(_b=null==data?void 0:data.totp)||void 0===_b?void 0:_b.qr_code)&&(data.totp.qr_code=`data:image/svg+xml;utf-8,${data.totp.qr_code}`),{data,error:null})}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}_verify(params){var _a;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{const{data:sessionData,error:sessionError}=yield this.getSession();if(sessionError)return{data:null,error:sessionError};const{data,error}=yield _request(this.fetch,"POST",`${this.url}/factors/${params.factorId}/verify`,{body:{code:params.code,challenge_id:params.challengeId},headers:this.headers,jwt:null===(_a=null==sessionData?void 0:sessionData.session)||void 0===_a?void 0:_a.access_token});return error?{data:null,error}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+data.expires_in},data)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",data),{data,error})}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}_challenge(params){var _a;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){try{const{data:sessionData,error:sessionError}=yield this.getSession();return sessionError?{data:null,error:sessionError}:yield _request(this.fetch,"POST",`${this.url}/factors/${params.factorId}/challenge`,{headers:this.headers,jwt:null===(_a=null==sessionData?void 0:sessionData.session)||void 0===_a?void 0:_a.access_token})}catch(error){if(isAuthError(error))return{data:null,error};throw error}}))}_challengeAndVerify(params){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const{data:challengeData,error:challengeError}=yield this._challenge({factorId:params.factorId});return challengeError?{data:null,error:challengeError}:yield this._verify({factorId:params.factorId,challengeId:challengeData.id,code:params.code})}))}_listFactors(){return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const{data:{user},error:userError}=yield this.getUser();if(userError)return{data:null,error:userError};const factors=(null==user?void 0:user.factors)||[],totp=factors.filter((factor=>"totp"===factor.factor_type&&"verified"===factor.status));return{data:{all:factors,totp},error:null}}))}_getAuthenticatorAssuranceLevel(){var _a,_b;return GoTrueClient_awaiter(this,void 0,void 0,(function*(){const{data:{session},error:sessionError}=yield this.getSession();if(sessionError)return{data:null,error:sessionError};if(!session)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const payload=this._decodeJWT(session.access_token);let currentLevel=null;payload.aal&&(currentLevel=payload.aal);let nextLevel=currentLevel;(null!==(_b=null===(_a=session.user.factors)||void 0===_a?void 0:_a.filter((factor=>"verified"===factor.status)))&&void 0!==_b?_b:[]).length>0&&(nextLevel="aal2");return{data:{currentLevel,nextLevel,currentAuthenticationMethods:payload.amr||[]},error:null}}))}}GoTrueClient.nextInstanceID=0;class SupabaseAuthClient extends GoTrueClient{constructor(options){super(options)}}var SupabaseClient_awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):function adopt(value){return value instanceof P?value:new P((function(resolve){resolve(value)}))}(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))};const DEFAULT_GLOBAL_OPTIONS={headers:module_lib_constants_DEFAULT_HEADERS},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};class SupabaseClient{constructor(supabaseUrl,supabaseKey,options){var _a,_b,_c,_d,_e,_f,_g,_h;if(this.supabaseUrl=supabaseUrl,this.supabaseKey=supabaseKey,!supabaseUrl)throw new Error("supabaseUrl is required.");if(!supabaseKey)throw new Error("supabaseKey is required.");const _supabaseUrl=function stripTrailingSlash(url){return url.replace(/\/$/,"")}(supabaseUrl);this.realtimeUrl=`${_supabaseUrl}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${_supabaseUrl}/auth/v1`,this.storageUrl=`${_supabaseUrl}/storage/v1`,this.functionsUrl=`${_supabaseUrl}/functions/v1`;const defaultStorageKey=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,settings=function applySettingDefaults(options,defaults){const{db:dbOptions,auth:authOptions,realtime:realtimeOptions,global:globalOptions}=options,{db:DEFAULT_DB_OPTIONS,auth:DEFAULT_AUTH_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,global:DEFAULT_GLOBAL_OPTIONS}=defaults;return{db:Object.assign(Object.assign({},DEFAULT_DB_OPTIONS),dbOptions),auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),authOptions),realtime:Object.assign(Object.assign({},DEFAULT_REALTIME_OPTIONS),realtimeOptions),global:Object.assign(Object.assign({},DEFAULT_GLOBAL_OPTIONS),globalOptions)}}(null!=options?options:{},{db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:defaultStorageKey}),global:DEFAULT_GLOBAL_OPTIONS});this.storageKey=null!==(_b=null===(_a=settings.auth)||void 0===_a?void 0:_a.storageKey)&&void 0!==_b?_b:"",this.headers=null!==(_d=null===(_c=settings.global)||void 0===_c?void 0:_c.headers)&&void 0!==_d?_d:{},this.auth=this._initSupabaseAuthClient(null!==(_e=settings.auth)&&void 0!==_e?_e:{},this.headers,null===(_f=settings.global)||void 0===_f?void 0:_f.fetch),this.fetch=fetchWithAuth(supabaseKey,this._getAccessToken.bind(this),null===(_g=settings.global)||void 0===_g?void 0:_g.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},settings.realtime)),this.rest=new PostgrestClient(`${_supabaseUrl}/rest/v1`,{headers:this.headers,schema:null===(_h=settings.db)||void 0===_h?void 0:_h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new StorageClient(this.storageUrl,this.headers,this.fetch)}from(relation){return this.rest.from(relation)}rpc(fn,args={},options){return this.rest.rpc(fn,args,options)}channel(name,opts={config:{}}){return this.realtime.channel(name,opts)}getChannels(){return this.realtime.getChannels()}removeChannel(channel){return this.realtime.removeChannel(channel)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var _a,_b;return SupabaseClient_awaiter(this,void 0,void 0,(function*(){const{data}=yield this.auth.getSession();return null!==(_b=null===(_a=data.session)||void 0===_a?void 0:_a.access_token)&&void 0!==_b?_b:null}))}_initSupabaseAuthClient({autoRefreshToken,persistSession,detectSessionInUrl,storage,storageKey,flowType},headers,fetch){const authHeaders={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl,headers:Object.assign(Object.assign({},authHeaders),headers),storageKey,autoRefreshToken,persistSession,detectSessionInUrl,storage,flowType,fetch})}_initRealtimeClient(options){return new RealtimeClient(this.realtimeUrl,Object.assign(Object.assign({},options),{params:Object.assign({apikey:this.supabaseKey},null==options?void 0:options.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((event,session)=>{this._handleTokenChanged(event,"CLIENT",null==session?void 0:session.access_token)}))}_handleTokenChanged(event,source,token){"TOKEN_REFRESHED"!==event&&"SIGNED_IN"!==event||this.changedAccessToken===token?"SIGNED_OUT"===event&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==source&&this.auth.signOut(),this.changedAccessToken=void 0):(this.realtime.setAuth(null!=token?token:null),this.changedAccessToken=token)}}const createClient=(supabaseUrl,supabaseKey,options)=>new SupabaseClient(supabaseUrl,supabaseKey,options);var cb,mod,dist_console=__webpack_require__("./node_modules/console-browserify/index.js"),__create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__toESM=(mod,isNodeMode,target)=>(target=null!=mod?__create(__getProtoOf(mod)):{},((to,from,except,desc)=>{if(from&&"object"==typeof from||"function"==typeof from)for(let key of __getOwnPropNames(from))__hasOwnProp.call(to,key)||key===except||__defProp(to,key,{get:()=>from[key],enumerable:!(desc=__getOwnPropDesc(from,key))||desc.enumerable});return to})(!isNodeMode&&mod&&mod.__esModule?target:__defProp(target,"default",{value:mod,enumerable:!0}),mod)),require_cookie=(cb={"../../node_modules/.pnpm/cookie@0.5.0/node_modules/cookie/index.js"(exports){exports.parse=function parse3(str,options){if("string"!=typeof str)throw new TypeError("argument str must be a string");for(var obj={},dec=(options||{}).decode||decode,index=0;index<str.length;){var eqIdx=str.indexOf("=",index);if(-1===eqIdx)break;var endIdx=str.indexOf(";",index);if(-1===endIdx)endIdx=str.length;else if(endIdx<eqIdx){index=str.lastIndexOf(";",eqIdx-1)+1;continue}var key=str.slice(index,eqIdx).trim();if(void 0===obj[key]){var val=str.slice(eqIdx+1,endIdx).trim();34===val.charCodeAt(0)&&(val=val.slice(1,-1)),obj[key]=tryDecode(val,dec)}index=endIdx+1}return obj},exports.serialize=function serialize3(name,val,options){var opt=options||{},enc=opt.encode||encode;if("function"!=typeof enc)throw new TypeError("option encode is invalid");if(!fieldContentRegExp.test(name))throw new TypeError("argument name is invalid");var value=enc(val);if(value&&!fieldContentRegExp.test(value))throw new TypeError("argument val is invalid");var str=name+"="+value;if(null!=opt.maxAge){var maxAge=opt.maxAge-0;if(isNaN(maxAge)||!isFinite(maxAge))throw new TypeError("option maxAge is invalid");str+="; Max-Age="+Math.floor(maxAge)}if(opt.domain){if(!fieldContentRegExp.test(opt.domain))throw new TypeError("option domain is invalid");str+="; Domain="+opt.domain}if(opt.path){if(!fieldContentRegExp.test(opt.path))throw new TypeError("option path is invalid");str+="; Path="+opt.path}if(opt.expires){var expires=opt.expires;if(!function isDate(val){return"[object Date]"===__toString.call(val)||val instanceof Date}(expires)||isNaN(expires.valueOf()))throw new TypeError("option expires is invalid");str+="; Expires="+expires.toUTCString()}if(opt.httpOnly&&(str+="; HttpOnly"),opt.secure&&(str+="; Secure"),opt.priority)switch("string"==typeof opt.priority?opt.priority.toLowerCase():opt.priority){case"low":str+="; Priority=Low";break;case"medium":str+="; Priority=Medium";break;case"high":str+="; Priority=High";break;default:throw new TypeError("option priority is invalid")}if(opt.sameSite)switch("string"==typeof opt.sameSite?opt.sameSite.toLowerCase():opt.sameSite){case!0:str+="; SameSite=Strict";break;case"lax":str+="; SameSite=Lax";break;case"strict":str+="; SameSite=Strict";break;case"none":str+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return str};var __toString=Object.prototype.toString,fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function decode(str){return-1!==str.indexOf("%")?decodeURIComponent(str):str}function encode(val){return encodeURIComponent(val)}function tryDecode(str,decode2){try{return decode2(str)}catch(e){return str}}}},function __require(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports}),import_cookie2=__toESM(require_cookie()),import_cookie=__toESM(require_cookie());function parseSupabaseCookie(str){if(!str)return null;try{const session=JSON.parse(str);if(!session)return null;if("Object"===session.constructor.name)return session;if("Array"!==session.constructor.name)throw new Error(`Unexpected format: ${session.constructor.name}`);const[_header,payloadStr,_signature]=session[0].split("."),payload=base64url_decode(payloadStr),decoder=new TextDecoder,{exp,sub,...user}=JSON.parse(decoder.decode(payload));return{expires_at:exp,expires_in:exp-Math.round(Date.now()/1e3),token_type:"bearer",access_token:session[0],refresh_token:session[1],provider_token:session[2],provider_refresh_token:session[3],user:{id:sub,factors:session[4],...user}}}catch(err){return dist_console.warn("Failed to parse cookie string:",err),null}}function stringifySupabaseSession(session){var _a;return JSON.stringify([session.access_token,session.refresh_token,session.provider_token,session.provider_refresh_token,(null==(_a=session.user)?void 0:_a.factors)??null])}function dist_isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}var DEFAULT_COOKIE_OPTIONS={path:"/",maxAge:31536e6},CookieAuthStorageAdapter=class{constructor(cookieOptions){this.cookieOptions={...DEFAULT_COOKIE_OPTIONS,...cookieOptions}}getItem(key){const value=this.getCookie(key);return value?key.endsWith("-code-verifier")?value:JSON.stringify(parseSupabaseCookie(value)):null}setItem(key,value){if(key.endsWith("-code-verifier"))return void this.setCookie(key,value);const sessionStr=stringifySupabaseSession(JSON.parse(value));this.setCookie(key,sessionStr)}removeItem(key){this.deleteCookie(key)}},BrowserCookieAuthStorageAdapter=class extends CookieAuthStorageAdapter{constructor(cookieOptions){super(cookieOptions)}getCookie(name){if(!dist_isBrowser())return null;return(0,import_cookie2.parse)(document.cookie)[name]}setCookie(name,value){if(!dist_isBrowser())return null;document.cookie=(0,import_cookie2.serialize)(name,value,{...this.cookieOptions,httpOnly:!1})}deleteCookie(name){if(!dist_isBrowser())return null;document.cookie=(0,import_cookie2.serialize)(name,"",{...this.cookieOptions,maxAge:0,httpOnly:!1})}};function createSupabaseClient(supabaseUrl,supabaseKey,options){var _a;const bowser=dist_isBrowser();return createClient(supabaseUrl,supabaseKey,{...options,auth:{flowType:"pkce",autoRefreshToken:bowser,detectSessionInUrl:bowser,persistSession:!0,storage:options.auth.storage,...(null==(_a=options.auth)?void 0:_a.storageKey)?{storageKey:options.auth.storageKey}:{}}})}var export_parseCookies=import_cookie.parse,export_serializeCookie=import_cookie.serialize},"./node_modules/cross-fetch/dist/browser-ponyfill.js":function(module,exports){var global="undefined"!=typeof self?self:this,__self__=function(){function F(){this.fetch=!1,this.DOMException=global.DOMException}return F.prototype=global,new F}();!function(self){!function(exports){var support_searchParams="URLSearchParams"in self,support_iterable="Symbol"in self&&"iterator"in Symbol,support_blob="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),support_formData="FormData"in self,support_arrayBuffer="ArrayBuffer"in self;if(support_arrayBuffer)var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&viewClasses.indexOf(Object.prototype.toString.call(obj))>-1};function normalizeName(name){if("string"!=typeof name&&(name=String(name)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(name))throw new TypeError("Invalid character in header field name");return name.toLowerCase()}function normalizeValue(value){return"string"!=typeof value&&(value=String(value)),value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:void 0===value,value}}};return support_iterable&&(iterator[Symbol.iterator]=function(){return iterator}),iterator}function Headers(headers){this.map={},headers instanceof Headers?headers.forEach((function(value,name){this.append(name,value)}),this):Array.isArray(headers)?headers.forEach((function(header){this.append(header[0],header[1])}),this):headers&&Object.getOwnPropertyNames(headers).forEach((function(name){this.append(name,headers[name])}),this)}function consumed(body){if(body.bodyUsed)return Promise.reject(new TypeError("Already read"));body.bodyUsed=!0}function fileReaderReady(reader){return new Promise((function(resolve,reject){reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error)}}))}function readBlobAsArrayBuffer(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsArrayBuffer(blob),promise}function bufferClone(buf){if(buf.slice)return buf.slice(0);var view=new Uint8Array(buf.byteLength);return view.set(new Uint8Array(buf)),view.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(body){this._bodyInit=body,body?"string"==typeof body?this._bodyText=body:support_blob&&Blob.prototype.isPrototypeOf(body)?this._bodyBlob=body:support_formData&&FormData.prototype.isPrototypeOf(body)?this._bodyFormData=body:support_searchParams&&URLSearchParams.prototype.isPrototypeOf(body)?this._bodyText=body.toString():support_arrayBuffer&&support_blob&&function isDataView(obj){return obj&&DataView.prototype.isPrototypeOf(obj)}(body)?(this._bodyArrayBuffer=bufferClone(body.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):support_arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(body)||isArrayBufferView(body))?this._bodyArrayBuffer=bufferClone(body):this._bodyText=body=Object.prototype.toString.call(body):this._bodyText="",this.headers.get("content-type")||("string"==typeof body?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):support_searchParams&&URLSearchParams.prototype.isPrototypeOf(body)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},support_blob&&(this.blob=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return function readBlobAsText(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsText(blob),promise}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function readArrayBufferAsText(buf){for(var view=new Uint8Array(buf),chars=new Array(view.length),i=0;i<view.length;i++)chars[i]=String.fromCharCode(view[i]);return chars.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},support_formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}Headers.prototype.append=function(name,value){name=normalizeName(name),value=normalizeValue(value);var oldValue=this.map[name];this.map[name]=oldValue?oldValue+", "+value:value},Headers.prototype.delete=function(name){delete this.map[normalizeName(name)]},Headers.prototype.get=function(name){return name=normalizeName(name),this.has(name)?this.map[name]:null},Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))},Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=normalizeValue(value)},Headers.prototype.forEach=function(callback,thisArg){for(var name in this.map)this.map.hasOwnProperty(name)&&callback.call(thisArg,this.map[name],name,this)},Headers.prototype.keys=function(){var items=[];return this.forEach((function(value,name){items.push(name)})),iteratorFor(items)},Headers.prototype.values=function(){var items=[];return this.forEach((function(value){items.push(value)})),iteratorFor(items)},Headers.prototype.entries=function(){var items=[];return this.forEach((function(value,name){items.push([name,value])})),iteratorFor(items)},support_iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Request(input,options){var body=(options=options||{}).body;if(input instanceof Request){if(input.bodyUsed)throw new TypeError("Already read");this.url=input.url,this.credentials=input.credentials,options.headers||(this.headers=new Headers(input.headers)),this.method=input.method,this.mode=input.mode,this.signal=input.signal,body||null==input._bodyInit||(body=input._bodyInit,input.bodyUsed=!0)}else this.url=String(input);if(this.credentials=options.credentials||this.credentials||"same-origin",!options.headers&&this.headers||(this.headers=new Headers(options.headers)),this.method=function normalizeMethod(method){var upcased=method.toUpperCase();return methods.indexOf(upcased)>-1?upcased:method}(options.method||this.method||"GET"),this.mode=options.mode||this.mode||null,this.signal=options.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(body)}function decode(body){var form=new FormData;return body.trim().split("&").forEach((function(bytes){if(bytes){var split=bytes.split("="),name=split.shift().replace(/\+/g," "),value=split.join("=").replace(/\+/g," ");form.append(decodeURIComponent(name),decodeURIComponent(value))}})),form}function Response(bodyInit,options){options||(options={}),this.type="default",this.status=void 0===options.status?200:options.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in options?options.statusText:"OK",this.headers=new Headers(options.headers),this.url=options.url||"",this._initBody(bodyInit)}Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var response=new Response(null,{status:0,statusText:""});return response.type="error",response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(-1===redirectStatuses.indexOf(status))throw new RangeError("Invalid status code");return new Response(null,{status,headers:{location:url}})},exports.DOMException=self.DOMException;try{new exports.DOMException}catch(err){exports.DOMException=function(message,name){this.message=message,this.name=name;var error=Error(message);this.stack=error.stack},exports.DOMException.prototype=Object.create(Error.prototype),exports.DOMException.prototype.constructor=exports.DOMException}function fetch(input,init){return new Promise((function(resolve,reject){var request=new Request(input,init);if(request.signal&&request.signal.aborted)return reject(new exports.DOMException("Aborted","AbortError"));var xhr=new XMLHttpRequest;function abortXhr(){xhr.abort()}xhr.onload=function(){var rawHeaders,headers,options={status:xhr.status,statusText:xhr.statusText,headers:(rawHeaders=xhr.getAllResponseHeaders()||"",headers=new Headers,rawHeaders.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(line){var parts=line.split(":"),key=parts.shift().trim();if(key){var value=parts.join(":").trim();headers.append(key,value)}})),headers)};options.url="responseURL"in xhr?xhr.responseURL:options.headers.get("X-Request-URL");var body="response"in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))},xhr.onerror=function(){reject(new TypeError("Network request failed"))},xhr.ontimeout=function(){reject(new TypeError("Network request failed"))},xhr.onabort=function(){reject(new exports.DOMException("Aborted","AbortError"))},xhr.open(request.method,request.url,!0),"include"===request.credentials?xhr.withCredentials=!0:"omit"===request.credentials&&(xhr.withCredentials=!1),"responseType"in xhr&&support_blob&&(xhr.responseType="blob"),request.headers.forEach((function(value,name){xhr.setRequestHeader(name,value)})),request.signal&&(request.signal.addEventListener("abort",abortXhr),xhr.onreadystatechange=function(){4===xhr.readyState&&request.signal.removeEventListener("abort",abortXhr)}),xhr.send(void 0===request._bodyInit?null:request._bodyInit)}))}fetch.polyfill=!0,self.fetch||(self.fetch=fetch,self.Headers=Headers,self.Request=Request,self.Response=Response),exports.Headers=Headers,exports.Request=Request,exports.Response=Response,exports.fetch=fetch,Object.defineProperty(exports,"__esModule",{value:!0})}({})}(__self__),__self__.fetch.ponyfill=!0,delete __self__.fetch.polyfill;var ctx=__self__;(exports=ctx.fetch).default=ctx.fetch,exports.fetch=ctx.fetch,exports.Headers=ctx.Headers,exports.Request=ctx.Request,exports.Response=ctx.Response,module.exports=exports},"./node_modules/es5-ext/global.js":module=>{var naiveFallback=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};module.exports=function(){if(this)return this;if("object"==typeof globalThis&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(error){return naiveFallback()}try{return __global__||naiveFallback()}finally{delete Object.prototype.__global__}}()},"./node_modules/set-cookie-parser/lib/set-cookie.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";var console=__webpack_require__("./node_modules/console-browserify/index.js"),defaultParseOptions={decodeValues:!0,map:!1,silent:!1};function isNonEmptyString(str){return"string"==typeof str&&!!str.trim()}function parseString(setCookieValue,options){var parts=setCookieValue.split(";").filter(isNonEmptyString),parsed=function parseNameValuePair(nameValuePairStr){var name="",value="",nameValueArr=nameValuePairStr.split("=");nameValueArr.length>1?(name=nameValueArr.shift(),value=nameValueArr.join("=")):value=nameValuePairStr;return{name,value}}(parts.shift()),name=parsed.name,value=parsed.value;options=options?Object.assign({},defaultParseOptions,options):defaultParseOptions;try{value=options.decodeValues?decodeURIComponent(value):value}catch(e){console.error("set-cookie-parser encountered an error while decoding a cookie with value '"+value+"'. Set options.decodeValues to false to disable this feature.",e)}var cookie={name,value};return parts.forEach((function(part){var sides=part.split("="),key=sides.shift().trimLeft().toLowerCase(),value=sides.join("=");"expires"===key?cookie.expires=new Date(value):"max-age"===key?cookie.maxAge=parseInt(value,10):"secure"===key?cookie.secure=!0:"httponly"===key?cookie.httpOnly=!0:"samesite"===key?cookie.sameSite=value:cookie[key]=value})),cookie}function parse(input,options){if(options=options?Object.assign({},defaultParseOptions,options):defaultParseOptions,!input)return options.map?{}:[];if(input.headers)if("function"==typeof input.headers.getSetCookie)input=input.headers.getSetCookie();else if(input.headers["set-cookie"])input=input.headers["set-cookie"];else{var sch=input.headers[Object.keys(input.headers).find((function(key){return"set-cookie"===key.toLowerCase()}))];sch||!input.headers.cookie||options.silent||console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),input=sch}if(Array.isArray(input)||(input=[input]),(options=options?Object.assign({},defaultParseOptions,options):defaultParseOptions).map){return input.filter(isNonEmptyString).reduce((function(cookies,str){var cookie=parseString(str,options);return cookies[cookie.name]=cookie,cookies}),{})}return input.filter(isNonEmptyString).map((function(str){return parseString(str,options)}))}module.exports=parse,module.exports.parse=parse,module.exports.parseString=parseString,module.exports.splitCookiesString=function splitCookiesString(cookiesString){if(Array.isArray(cookiesString))return cookiesString;if("string"!=typeof cookiesString)return[];var start,ch,lastComma,nextStart,cookiesSeparatorFound,cookiesStrings=[],pos=0;function skipWhitespace(){for(;pos<cookiesString.length&&/\s/.test(cookiesString.charAt(pos));)pos+=1;return pos<cookiesString.length}for(;pos<cookiesString.length;){for(start=pos,cookiesSeparatorFound=!1;skipWhitespace();)if(","===(ch=cookiesString.charAt(pos))){for(lastComma=pos,pos+=1,skipWhitespace(),nextStart=pos;pos<cookiesString.length&&"="!==(ch=cookiesString.charAt(pos))&&";"!==ch&&","!==ch;)pos+=1;pos<cookiesString.length&&"="===cookiesString.charAt(pos)?(cookiesSeparatorFound=!0,pos=nextStart,cookiesStrings.push(cookiesString.substring(start,lastComma)),start=pos):pos=lastComma+1}else pos+=1;(!cookiesSeparatorFound||pos>=cookiesString.length)&&cookiesStrings.push(cookiesString.substring(start,cookiesString.length))}return cookiesStrings}},"./node_modules/websocket/lib/browser.js":(module,__unused_webpack_exports,__webpack_require__)=>{var _globalThis;if("object"==typeof globalThis)_globalThis=globalThis;else try{_globalThis=__webpack_require__("./node_modules/es5-ext/global.js")}catch(error){}finally{if(_globalThis||"undefined"==typeof window||(_globalThis=window),!_globalThis)throw new Error("Could not determine global this")}var NativeWebSocket=_globalThis.WebSocket||_globalThis.MozWebSocket,websocket_version=__webpack_require__("./node_modules/websocket/lib/version.js");function W3CWebSocket(uri,protocols){return protocols?new NativeWebSocket(uri,protocols):new NativeWebSocket(uri)}NativeWebSocket&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach((function(prop){Object.defineProperty(W3CWebSocket,prop,{get:function(){return NativeWebSocket[prop]}})})),module.exports={w3cwebsocket:NativeWebSocket?W3CWebSocket:null,version:websocket_version}},"./node_modules/websocket/lib/version.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/websocket/package.json").version},"./node_modules/websocket/package.json":module=>{"use strict";module.exports={version:"1.0.34"}}}]);